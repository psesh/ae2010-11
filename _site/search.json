[
  {
    "objectID": "Taylor_Calculations.html",
    "href": "Taylor_Calculations.html",
    "title": "",
    "section": "",
    "text": "CodeShow All CodeHide All Code\n\n\n\n\n\nCode\n# load in libraries\nfrom equadratures import *\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\n\n\npressure assumption: \\(\\frac{p}{p_0} = y = R^{-3}f_1\\) [1]\ndensity assumption: \\(\\frac{\\rho}{\\rho_0} = \\psi\\) [2]\nvelocity assumption: \\(u = R^{-3/2}\\phi_1\\) [3]\nwhere \\(f_1\\), \\(\\psi\\), and \\(\\phi_1\\) are functions of \\(\\eta = \\frac{r}{R}\\) where \\(r\\) is the radial position and \\(R\\) is the radius of the shock wave\nUsing the Navier-Stokes equation: \\(\\rho \\frac{Du}{Dt} = -\\nabla p + \\rho g + \\mu \\nabla^2 u\\) under the assumption of no gravitational or viscous effects we have \\(\\rho \\frac{Du}{Dt} = -\\nabla p\\), using the defintion of a materal derivative and the equations for denisty, pressure, and velocity from above we get [4]:\n\\[\n\\large\n\\rho \\left(\\frac{\\partial u}{\\partial t} + (u \\cdot \\nabla)u\\right) = -\\frac{\\partial p}{\\partial r} \\longrightarrow \\rho \\left(\\frac{\\partial u}{\\partial t} + (u \\cdot \\nabla)u\\right) = -\\frac{p_0}{\\rho}\\frac{\\partial y}{\\partial r}\n\\]\n\\[\n\\large\n\\left(\\frac{\\partial (R^{-3/2}\\phi_1)}{\\partial t} + R^{-3/2}\\phi_1 \\left(\\frac{\\partial (R^{-3/2} \\phi_1)}{\\partial r}\\right)\\right) = -\\frac{p_0}{\\rho_0\\psi} \\frac{\\partial ( R^{-3} f_1)}{\\partial r}\n\\]\n\\[\n\\large\nR^{-3/2}\\frac{\\partial \\phi_1}{\\partial t} - \\frac{3}{2}R^{-5/2}\\frac{dR}{dt}\\phi_1 + R^{-3/2}\\phi_1 \\left(R^{-3/2}\\frac{\\partial \\phi_1}{\\partial r}\\right) = -\\frac{p_0}{\\rho_0 \\psi} R^{-3} \\frac{\\partial f_1}{\\partial r}\n\\]\nSince \\(f_1\\) and \\(\\phi_1\\) are functions of \\(\\eta\\) their partial derivatives can be expanded:\n\\[\n\\large\nR^{-3/2}\\frac{\\partial \\phi_1}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial t}- \\frac{3}{2}R^{-5/2}\\frac{dR}{dt}\\phi_1 + R^{-3/2}\\phi_1 \\left(R^{-3/2}\\frac{\\partial \\phi_1}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial r}\\right) = -\\frac{p_0}{\\rho_0 \\psi} R^{-3} \\frac{\\partial f_1}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial r}\n\\]\nWriting \\(\\frac{\\partial \\phi_1}{\\partial \\eta}\\) as \\(\\phi_1'\\) and \\(\\frac{\\partial f_1}{\\partial \\eta}\\) as \\(f_1'\\) and using \\(\\frac{\\partial \\eta}{\\partial t} = \\frac{\\partial r/R}{\\partial t} = -\\frac{r}{R^2} \\frac{dR}{dt}\\) and \\(\\frac{\\partial \\eta}{\\partial r}=\\frac{\\partial r/R}{\\partial t}=\\frac{1}{R}\\) we get that:\n\\[\n\\large\n-R^{-3/2}\\phi_1'\\frac{r}{R^2}\\frac{dR}{dt}- \\frac{3}{2}R^{-5/2}\\frac{dR}{dt}\\phi_1 + R^{-3/2}\\phi_1 \\left(R^{-3/2}\\phi_1'\\frac{1}{R}\\right) = -\\frac{p_0}{\\rho_0 \\psi} R^{-3} f_1'\\frac{1}{R}\n\\]\nSimplifying this we have [5]:\n\\[\n\\large\n-\\left(\\frac{3}{2}\\phi_1 + \\eta\\phi_1'\\right)R^{-5/2}\\frac{dR}{dt} + R^{-4}\\left(\\phi_1\\phi_1' + \\frac{p_0}{\\rho_0 \\psi}f_1'\\right) = 0\n\\]\nThis equation can be satisfied when \\(\\frac{dR}{dt}=AR^{-3/2}\\) [6] where A is some constant and in the end we could simplify  [5] to get  [7]):\n\\[\n\\large\n-\\left(\\frac{3}{2}\\phi_1 + \\eta\\phi_1'\\right)R^{-5/2}AR^{-3/2} + R^{-4}\\left(\\phi_1\\phi_1' + \\frac{p_0}{\\rho_0 \\psi}f_1'\\right) = 0\n\\]\n\\[\n\\large\n\\longrightarrow -A\\left(\\frac{3}{2}\\phi_1 + \\eta\\phi_1'\\right) + \\left(\\phi_1\\phi_1' + \\frac{p_0}{\\rho_0 \\psi}f_1'\\right) = 0\n\\]\nContinuing on and using the equation of continuity \\(\\frac{\\partial \\rho}{\\partial t} + u \\frac{\\partial \\rho}{\\partial r} + \\rho\\left(\\frac{\\partial u}{\\partial r} + \\frac{2u}{r}\\right)=0\\) [8] we can use the same equations for denisty and velocity:\n\\[\n\\large\n\\rho_0 \\frac{\\partial \\psi}{\\partial t} + \\rho_0R^{-3/2}\\phi_1 \\frac{\\partial \\psi}{\\partial r} + \\rho_0\\psi \\left(R^{-3/2}\\frac{\\partial \\phi_1}{\\partial r} + \\frac{2R^{-3/2}\\phi_1}{r}\\right)=0\n\\]\n\\[\n\\large\n\\rho_0 \\frac{\\partial \\psi}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial t} + \\rho_0R^{-3/2}\\phi_1 \\frac{\\partial \\psi}{\\partial \\eta}\\frac{\\partial \\eta}{\\partial r} + \\rho_0\\psi \\left(R^{-3/2}\\frac{\\partial \\phi_1}{\\partial \\eta}{\\partial \\eta}{\\partial r} + \\frac{2R^{-3/2}\\phi_1}{r}\\right)=0\n\\]\n\\[\n\\large\n\\rho_0 \\psi'\\left(-\\frac{r}{R^2}\\frac{dR}{dt}\\right)+ \\rho_0R^{-3/2}\\phi_1 \\psi'\\frac{1}{R} + \\rho_0\\psi \\left(R^{-3/2}\\phi_1'\\frac{1}{R} + \\frac{2R^{-3/2}\\phi_1}{r}\\right)=0\n\\]\n\\[\n\\large\n\\rho_0 \\psi'\\left(-\\frac{r}{R^2}AR^{-3/2}\\right)+ \\rho_0R^{-5/2}\\phi_1 \\psi' + \\rho_0\\psi \\left(R^{-5/2}\\phi_1' + \\frac{2R^{-3/2}\\phi_1}{r}\\right)=0\n\\]\n\\[\n\\large\n-A\\eta \\psi'R^{-5/2}+ R^{-5/2}\\phi_1 \\psi' + \\psi \\left(R^{-5/2}\\phi_1' + \\frac{2R^{-5/2}\\phi_1}{\\eta}\\right)=0\n\\]\nSimplifying this we have  [9]:\n\\[\n\\large\n-A\\eta \\psi'+ \\phi_1 \\psi' + \\psi \\left(\\phi_1' + \\frac{2\\phi_1}{\\eta}\\right)=0 \\ (9)\n\\]\nFor a perfect gas \\(p\\rho^{-\\gamma} = const\\) therefore \\(\\frac{D(p\\rho^{-\\gamma})}{Dt}=0\\) and therefore \\(\\frac{\\partial (p\\rho^{-\\gamma})}{\\partial t} + u \\frac{\\partial (p \\rho^{-\\gamma})}{\\partial r} =0\\) [10]\n\\[\n\\large\np \\frac{\\partial \\rho^{-\\gamma}}{\\partial t} + \\rho^{-\\gamma} \\frac{\\partial p}{\\partial t} + u\\left(p \\frac{\\partial \\rho^{-\\gamma}}{\\partial r} + \\rho^{-\\gamma} \\frac{\\partial p}{\\partial r}\\right)=0\n\\]\n\\[\n\\large\n-\\gamma p \\rho^{-\\gamma-1}\\frac{\\partial \\rho}{\\partial t} + \\rho^{-\\gamma} \\frac{\\partial p}{\\partial t} + u\\left(-\\gamma p \\rho^{-\\gamma-1}\\frac{\\partial \\rho}{\\partial r} + \\rho^{-\\gamma} \\frac{\\partial p}{\\partial r}\\right)=0\n\\]\n\\[\n\\large\n-\\gamma p \\rho^{-1}\\frac{\\partial \\rho}{\\partial t} +  \\frac{\\partial p}{\\partial t} + u\\left(-\\gamma p \\rho^{-1}\\frac{\\partial \\rho}{\\partial r} + \\frac{\\partial p}{\\partial r}\\right)=0\n\\]\n\\[\n\\large\n-\\gamma p_0R^{-3}f_1 \\rho_0(\\rho_0 \\psi)^{-1}\\frac{\\partial \\psi}{\\partial t} -3 f_1 p_0 R^{-4}\\frac{dR}{dt} + p_0R^{-3}\\frac{\\partial f_1}{\\partial t} + u\\left(-\\gamma p_0R^{-3}f_1 \\rho_0(\\rho_0 \\psi)^{-1}\\frac{\\partial \\psi}{\\partial r} + p_0R^{-3}\\frac{\\partial f_1}{\\partial r}\\right)=0\n\\]\n\\[\n\\large\n-\\gamma p_0R^{-3}f_1 \\psi^{-1} \\psi' \\left(-\\frac{r}{R^2}\\frac{dR}{dt}\\right) -3 f_1 p_0 R^{-4}\\frac{dR}{dt} +  R^{-3}p_0f_1' \\left(-\\frac{r}{R^2}\\frac{dR}{dt}\\right) + u\\left(-\\gamma p_0R^{-3}f_1 \\psi^{-1}\\psi'\\frac{1}{R} + p_0R^{-3}f_1'\\frac{1}{R}\\right)=0\n\\]\n\\[\n\\large\nA\\gamma p_0R^{-11/2}f_1\\eta \\psi^{-1} \\psi' -3 f_1 p_0 R^{-4}AR^{-3/2} +  A\\eta R^{-11/2}p_0f_1' + R^{-3/2}\\phi_1 \\left(-\\gamma p_0R^{-4}f_1 \\psi^{-1}\\psi' + p_0R^{-4}f_1'\\right)=0\n\\]\n\\[\n\\large\nA\\gamma f_1\\eta \\psi^{-1} \\psi' -3f_1A +  A\\eta f_1' + \\phi_1 \\left(-\\gamma f_1 \\psi^{-1}\\psi' + f_1'\\right)=0\n\\]\n\\[\n\\large\n-A(3f_1 + \\eta f_1') +\\gamma f_1\\psi^{-1} \\psi'( A\\eta -\\phi_1) + \\phi_1f_1'=0\n\\]\nSimplifying this becomes  [11]: \\[\n\\large\nA(3f_1 + \\eta f_1') +\\gamma f_1\\frac{\\psi'}{\\psi}(\\phi_1 - A\\eta) - \\phi_1f_1'=0\n\\]\nWe can reduce [7], [9], and [11] by forming nondimensional forms of \\(f_1\\) and \\(\\phi_1\\) where \\(f=f_1\\frac{a^2}{A^2}\\) (12) and \\(\\phi = \\frac{\\phi_1}{A}\\) (13) where \\(a^2 = \\gamma \\frac{p_0}{\\rho_0}\\) and is the speed of sound. Doing this for [7] we get [7a]:\n\\[\n\\large\n-A\\left(\\frac{3}{2}A\\phi + \\eta A\\phi'\\right) + \\left(A^2\\phi\\phi' + \\frac{p_0}{\\rho_0 \\psi}\\frac{A^2}{a^2}f'\\right) = 0\n\\]\n\\[\n\\large\n-\\frac{3}{2}\\phi  + \\frac{p_0}{\\rho_0 \\psi}\\frac{\\rho_0}{\\gamma p_0}f' = \\eta \\phi' - \\phi\\phi'\n\\]\n\\[\n\\large\n\\phi'(\\eta - \\phi)= \\frac{1}{\\gamma}\\frac{f'}{\\psi} -\\frac{3}{2}\\phi\n\\]\nUsing the subsitutions in [9] gives  [9a]:\n\\[\n\\large\n-A\\eta \\psi'+ A\\phi \\psi' + \\psi \\left(A\\phi' + \\frac{2A\\phi}{\\eta}\\right)=0\n\\]\n\\[\n\\large\n\\psi \\left(\\phi' + \\frac{2\\phi}{\\eta}\\right)=\\psi'(\\eta -\\phi)\n\\]\n\\[\n\\large\n\\frac{\\psi'}{\\psi} = \\frac{\\left(\\phi' + \\frac{2\\phi}{\\eta}\\right)}{\\eta -\\phi}\n\\]\nUsing the substitution in [11] gives [11a]:\n\\[\n\\large\nA(3\\frac{A^2}{a^2}f + \\eta \\frac{A^2}{a^2}f') +\\gamma \\frac{A^2}{a^2}f\\frac{\\psi'}{\\psi}(A\\phi - A\\eta) - A\\phi\\frac{A^2}{a^2}f'=0\n\\]\n\\[\n\\large\n3f + \\eta f' +\\gamma f\\frac{\\psi'}{\\psi}(\\phi - \\eta) - \\phi f'=0\n\\]\nSubstituting [7a] and  [9a] into [11a] gives [14]:\n\\[\n\\large\n3f + \\eta f' +\\gamma f\\frac{\\left(\\phi' + \\frac{2\\phi}{\\eta}\\right)}{\\eta -\\phi}(\\phi - \\eta) - \\phi f'=0\n\\]\n\\[\n\\large\n3f + \\eta f' -\\gamma f\\left(\\phi' + \\frac{2\\phi}{\\eta}\\right) - \\phi f'=0\n\\]\n\\[\n\\large\n3f + \\eta f' -\\gamma f\\left(\\frac{\\frac{1}{\\gamma}\\frac{f'}{\\psi} - \\frac{3}{2}\\phi}{\\eta - \\phi} + \\frac{2\\phi}{\\eta}\\right) - \\phi f'=0\n\\]\n\\[\n\\large\nf'\\left((\\eta - \\phi)^2 - \\frac{f}{\\psi}\\right) = f\\left(-3\\eta + \\phi\\left(3 + \\frac{1}{2}\\gamma\\right) - \\frac{2\\gamma \\phi^2}{\\eta}\\right)\n\\]\nUsing the Rankine-Hugoniot relations and reducing we get [15], [16], and [17]:\n\\[\n\\large\n\\frac{\\rho_1}{\\rho_0} = \\frac{\\gamma - 1 +(\\gamma+1)y_1}{\\gamma+1 + (\\gamma-1)y_1}\n\\]\n\\[\n\\large\n\\frac{U^2}{a^2} = \\frac{1}{2\\gamma}(\\gamma -1 + (\\gamma+1)y_1)\n\\]\n\\[\n\\large\n\\frac{u_1}{U} = \\frac{2(y_1-1)}{\\gamma-1 + (\\gamma+1)y_1}\n\\]\nWhere \\(\\rho_1\\), \\(y_1\\), and \\(u_1\\) are the values of \\(\\rho\\), \\(\\gamma\\), and \\(y_1\\) immediately behind/before the shock and \\(U=\\frac{dR}{dt}\\), we can simplify these for the case where \\(y_1 &gt;&gt;\\) to get [15a], [16a], and [17a]:\n\\[\n\\large\n\\frac{\\rho_1}{\\rho_0} = \\frac{\\gamma+1}{\\gamma-1}\n\\]\n\\[\n\\large\n\\frac{U^2}{a^2} = \\frac{\\gamma +1}{2\\gamma}y_1\n\\]\n\\[\n\\large\n\\frac{u_1}{U} = \\frac{2}{\\gamma+1}\n\\]\nSince \\(\\psi=\\frac{\\rho}{\\rho_0}\\) [15a] becomes [15b]:\n\\[\n\\large\n\\psi = \\frac{\\gamma+1}{\\gamma-1}\n\\]\nNext, since \\(f=\\frac{a^2}{A^2}\\) then \\(a^2=\\frac{A^2f}{f_1}\\) and because \\(U=\\frac{dR}{dt}=AR^{-3/2}\\) then \\(U^2=A^2R^{-3}\\), additionally \\(y=R^{-3}f_1\\) using these equations [16a] becomes [16b]:\n\\[\n\\large\n\\frac{A^2R^{-3}f_1}{A^2f} = \\frac{\\gamma + 1}{2\\gamma}R^{-3}f_1\n\\]\n\\[\n\\large\nf = \\frac{2\\gamma}{\\gamma + 1}\n\\]\nLastly, for [17a] we can use that \\(u=R^{-3/2}A\\phi\\) and \\(U=\\frac{dR}{dt}=AR^{-3/2}\\) to get [17b]:\n\\[\n\\large\n\\frac{AR^{-3/2}\\phi}{AR^{-3/2}} = \\frac{2}{\\gamma+1}\n\\]\n\\[\n\\large\n\\phi = \\frac{2}{\\gamma+1}\n\\]\nNote: In Taylor’s paper [16a] is different:  However, this does not derive from equation 16 and does not simplify to [16b] so I’m not sure what he did but the end result of [16b] is the same\nBy using ([15b], [16b], [17b]) and using that \\(\\gamma=1.4\\) we can get values for \\(f\\), \\(\\phi\\), and \\(\\psi\\) at \\(\\eta=1\\):\n\n\nCode\n# define values at eta=1\nf_0 = 7/6\nphi_0 = 5/6\npsi_0 = 6\ng = 1.4\n\n\nUsing [14], [7a], and  [9a] we can define functions to calculation \\(f'\\), \\(\\phi'\\), and \\(\\psi'\\)\n\n\nCode\n# define f'\ndef dev_f(f, phi, psi, eta):\n    f_prime = (f*(-3*eta+phi*(3+0.5*g)-(2*g*phi**2)/eta))/((eta-phi)**2 -f/psi)\n    return f_prime \n\n\n\n\nCode\n# define phi'\ndef dev_phi(f, phi, psi, eta):\n    f_prime = dev_f(f, phi, psi, eta)\n    phi_prime = ((1/g)*(f_prime/psi)-(3/2)*(phi))/(eta-phi)\n    return phi_prime\n\n\n\n\nCode\n# define psi'\ndef dev_psi(f, phi, psi, eta):\n    phi_prime = dev_phi(f, phi, psi, eta)\n    psi_prime = psi*(phi_prime+2*phi/eta)/(eta-phi)\n    return psi_prime\n\n\nTo find an approximate function for \\(f\\), \\(\\phi\\), and \\(\\psi\\) we can calcuate the change at very small increments\n\n\nCode\netas = np.linspace(1,0.5, 100)\n\n\n\n\nCode\n# step by step calculation \nfs = []\nphis = []\npsis = []\n\nf = f_0\nphi = phi_0\npsi = psi_0\n\nf_prime_list = []\n\ndelta = np.mean(np.diff(etas))\nfor eta in etas:\n    fs.append(f)\n    phis.append(phi)\n    psis.append(psi)\n    \n    f_prime = dev_f(f, phi, psi, eta)\n    phi_prime = dev_phi(f, phi, psi, eta)\n    psi_prime = dev_psi(f, phi, psi, eta) \n    f_prime_list.append(f_prime)\n    \n    f += delta*f_prime\n    phi += delta*phi_prime\n    psi += delta*psi_prime\n\n\nThe output for \\(\\phi\\) is very nearly linear and can be approximated using [14] and  [9a]:\n\\[\n\\large\n3f + \\eta f' -\\gamma f\\left(\\phi' + \\frac{2\\phi}{\\eta}\\right) - \\phi f'=0\n\\] Note: in Taylor [19] is written differently but both forms are equivalent\nThis can be simplifed to get [20]\n\\[\n\\large\n\\frac{f'}{f}(\\eta - \\phi) = \\gamma \\phi' + \\frac{2\\gamma \\phi}{\\eta} - 3\n\\]\nIf the left-hand side is ignored then the solution is \\(\\phi = \\frac{\\eta}{\\gamma}\\) [21] this linear relationship follows what is calculated by the step process however it starts to break away at high values of \\(\\eta\\) meaning there is a correction factor of the form \\(\\alpha\\eta^n\\) where \\(\\alpha\\) and n are constants [22]\n\\[\n\\large\n\\phi = \\frac{\\eta}{\\gamma} + \\alpha\\eta^n\n\\]\nThese constants can be found using [16b] and [17b], firstly by using [17b] and plugging that value in for \\(\\phi\\) at \\(\\eta=1\\) we get [23]:\n\\[\n\\large\n\\frac{2}{\\gamma +1} = \\frac{1}{\\gamma} + \\alpha (1)^n \\longrightarrow \\alpha = \\frac{\\gamma -1}{\\gamma(\\gamma +1)}\n\\]\nNext, we can use ([15b], [16b], [17b]) to find the true value of \\(f'\\) at \\(\\eta=1\\) getting that \\(f' = \\frac{2\\gamma^2 +7\\gamma-3}{\\gamma-1}\\), next we can take the derivative of [22] to get \\(\\phi' = \\frac{1}{\\gamma} +\\alpha n \\eta^{n-1}\\) then plug this value into [20] and set them equal in order to calculate n [24]:\n\\[\n\\large\nn = \\frac{7\\gamma-1}{\\gamma^2 -1}\n\\]\nThen we can use [22] to solve for \\(f\\) and \\(\\psi\\), firstly plugging [22] into [20] we get [25]:\n\\[\n\\large\n\\frac{f'}{f} = \\frac{(n+2)\\alpha\\gamma^2\\eta^{n-2}}{\\gamma-1-\\gamma\\alpha\\eta^{n-1}}\n\\]\nTaking the derivative and solving for the derivation constant using the value of \\(f\\) at \\(\\eta=1\\) we get that [26]:\n\\[\n\\large\nln(f) = ln\\left(\\frac{2\\gamma}{\\gamma+1}\\right) - \\frac{2\\gamma^2+7\\gamma-3}{7-\\gamma}ln\\left(\\frac{\\gamma+1-\\eta^{n-1})}{\\gamma}\\right)\n\\]\nNext we can use [22] and its derivative to solve for \\(\\psi\\) by using  [9a]:\n\\[\n\\large\n\\frac{\\psi'}{\\psi} = \\frac{\\frac{1}{\\gamma} + \\alpha n \\eta^{n-1} + \\frac{2}{\\eta}\\left(\\frac{\\eta}{\\gamma} + \\alpha \\eta^n\\right)}{\\eta - \\left(\\frac{\\eta}{\\gamma} + \\alpha\\eta^n\\right)}=\\frac{3+(n+2)\\gamma\\alpha\\eta^{n-1}}{(\\gamma-1)\\eta-\\alpha\\gamma\\eta^n}\n\\]\nTaking the derivative and solving for \\(\\psi\\) gets  [28]:\n\\[\n\\large\nln(\\psi) = ln\\left(\\frac{\\gamma+1}{\\gamma-1}\\right)+\\frac{3}{\\gamma-1}ln(\\eta)-2\\frac{\\gamma+5}{7-\\gamma}ln\\left(\\frac{\\gamma+1-\\eta^{n-1}}{\\gamma}\\right)\n\\]\nBelow we can check these equations for \\(\\phi\\), \\(f\\), and \\(\\psi\\)\n\n\nCode\n# guess constants and values\na = (g-1)/(g*(g+1))\nn = (7*g-1)/(g**2-1)\nphi_guess = etas/g\nphi_guess_corrected = etas/g + a*etas**n\nf_guess_corrected = (2*g/(g+1))*(((g+1)/g)-((etas**(n-1))/g))**(-(2*g**2+7*g-3)/(7-g))\npsi_guess_corrected = ((g+1)/(g-1))*(etas**(3/(g-1)))*((g+1-etas**(n-1))/g)**(-2*(g+5)/(7-g))\n\n\n\n\nCode\n# taylors data\ntaylor_etas = np.linspace(1,0.5,26)\ntaylor_fs = [f_0, 0.949, 0.808, 0.711, 0.643, 0.593, 0.556, 0.528, 0.507, 0.491, 0.478, 0.468, 0.461, 0.455, 0.45, 0.447, \n             0.444, 0.442, 0.44, 0.439, 0.438, 0.438, 0.437, 0.437, 0.437, 0.436]\ntaylor_phis = [phi_0, 0.798, 0.767, 0.737, 0.711, 0.687, 0.665, 0.644, 0.625, 0.607, 0.590, 0.573, 0.557, 0.542, 0.527, \n               0.513, 0.498, 0.484, 0.47, 0.456, 0.443, 0.428, 0.415, 0.402, 0.389, 0.375]\ntaylor_psis = [psi_0, 4, 2.808, 2.052, 1.534, 1.177, 0.919, 0.727, 0.578, 0.462, 0.37, 0.297, 0.239, 0.191, 0.152, 0.12, \n               0.095, 0.074, 0.058, 0.044, 0.034, 0.026, 0.019, 0.014, 0.01, 0.007]\n\n\n\n\nCode\nfig = go.Figure()\n\nfig.add_scatter(x=etas, y=fs, name='step', line_color = 'skyblue')\nfig.add_scatter(x=taylor_etas, y=taylor_fs, name='Taylor', line_color='darkviolet', line_dash='dash')\nfig.add_scatter(x=etas, y=f_guess_corrected, name='corrected guess', line_dash='dot', line_color='deeppink')\n\nfig.add_scatter(x=etas, y=phis, visible=False, name='step', line_color='skyblue')\nfig.add_scatter(x=taylor_etas, y=taylor_phis, visible=False, name='Taylor', line_dash='dash', line_color='darkviolet')\nfig.add_scatter(x=etas, y=phi_guess, visible=False, name='guess', line_dash='dashdot', line_color='pink')\nfig.add_scatter(x=etas, y=phi_guess_corrected, visible=False, name='corrected guess', line_dash='dot', line_color='deeppink')\n\nfig.add_scatter(x=etas, y=psis, visible=False, name='step', line_color='skyblue')\nfig.add_scatter(x=taylor_etas, y=taylor_psis, visible=False, name='Taylor', line_dash='dash', line_color='darkviolet')\nfig.add_scatter(x=etas, y=psi_guess_corrected, visible=False, name='corrected guess', line_dash='dot', line_color='deeppink')\n\nfig.update_layout(updatemenus=[dict(active=0, buttons=[dict(label='f', method='update', \n                  args=[{'visible':[True, True, True, False, False, False, False, False, False, False]}]), \n                  dict(label=r'$\\phi$', method='update', args=[{'visible':[False, False, False, True, True, True, True, \n                  False, False, False]}]), dict(label=r'$\\psi$', method='update', args=[{'visible':[False, False, False, \n                  False, False, False, False, True, True, True]}])])])\n\nfig.update_xaxes(title=r'$\\eta \\left(\\frac{r}{R}\\right)$')\n\nfig.show()\n\n\n\n                                                \n\n\nTo calculate the energy of the explosion we need to look at two parts, kinetic and heat\nKinetic energy in integral form using spherical coordinates is \\(KE=4\\pi\\int_0^Rfrac{1}{2}\\rho u^2r^2dr\\)\nIn terms of the variables \\(\\phi\\), \\(\\psi\\), \\(f\\), and \\(\\eta\\) we can write this as:\n\\[\n\\large\n2\\pi\\int_0^11 \\rho_0\\psi A^2R^{-3}\\phi^2 R^2\\eta^2 Rd\\eta = 2\\pi A^2\\rho_0\\int_0^1 \\psi \\phi^2 \\eta^2 d\\eta\n\\]\nHeat energy in integral form using spherical coordinates is \\(HE=4\\pi\\int_0^R\\frac{pr^2}{\\gamma-1}dr\\)\nIn terms of the variables \\(\\phi\\), \\(\\psi\\), \\(f\\), and \\(\\eta\\) we can write this as:\n\\[\n\\large\n\\frac{4\\pi}{\\gamma-1} \\int_0^1 p_0 \\frac{A^2}{a^2}fR^{-3} R^2\\eta^2 Rd\\eta = \\frac{4\\pi A^2 \\rho_0}{\\gamma(\\gamma-1)} \\int_0^1 f \\eta^2 d\\eta\n\\]\nTherefore the total Energy of the system can be written as:\n\\[\n\\large\nE = 2\\pi A^2 \\rho_0 \\left(\\int_0^1 \\psi \\phi^2 \\eta^2 d\\eta + \\frac{2}{\\gamma(\\gamma-1)}\\int_0^1 f \\eta^2 d\\eta\\right)\n\\]\nUsing that \\(\\frac{dR}{dt}=AR^{-3/2}\\) we can integrate and solve for A to get that \\(A=\\frac{2}{5}R^{5/2}t^{-1}\\) therefore:\n\\[\n\\large\nE = 2\\pi \\frac{4}{25}R^5t^{-2} \\rho_0 \\left(\\int_0^1 \\psi \\phi^2 \\eta^2 d\\eta + \\frac{2}{\\gamma(\\gamma-1)}\\int_0^1 f \\eta^2 d\\eta\\right)\n\\]\nWe can state that \\(K=\\frac{4}{25}\\left(2\\pi\\int_0^1 \\psi \\phi^2 \\eta^2 d\\eta + \\frac{4\\pi}{\\gamma(\\gamma-1)}\\int_0^1 f \\eta^2 d\\eta\\right)\\) so that the energy is \\(E=K\\rho_0R^5t^{-2}\\)\n\n\nCode\neta_p = Parameter(lower=0, upper=1, order=10)\nbasis = Basis('tensor-grid')\npoly = Poly(parameters=eta_p, basis=basis, method='numerical-integration')\npts, wts = poly.get_points_and_weights()\n\n\n\n\nCode\ndef K(gamma, eta):\n    a = (gamma-1)/(gamma*(gamma+1))\n    n = (7*gamma - 1)/(gamma**2 - 1)\n    phi = (eta/gamma) + a*eta**n\n    log_psi = np.log((gamma+1)/(gamma-1)) + 3/(gamma-1) * np.log(eta) - 2*(gamma+5)/(7-gamma) * \\\n              np.log((gamma+1-eta**(n-1))/gamma)\n    psi = np.exp(log_psi)\n    log_f = np.log(2*gamma/(gamma+1)) - (2*gamma**2 + 7*gamma - 3)/(7-gamma) * np.log((gamma+1-eta**(n-1))/gamma)\n    f = np.exp(log_f)\n    I_1 = wts @ (eta**2 * phi**2 * psi)\n    I_2 = wts @ (eta**2 * f)\n    return 4/25 * (2*np.pi*I_1 + 4*np.pi/(gamma*(gamma-1)) * I_2)\n\n\n\n\nCode\ngammas = np.linspace(1.2, 1.7, 100)\n\n\n\n\nCode\nKs = []\nfor gamma in gammas:\n    Ks.append(K(gamma, pts))\n\n\n\n\nCode\nrho_0 = 1.25 # kg/m^3\nergs = 1e7 # ergs/J\ntnt = 4.25e16 # ergs/tons TNT\n\n\nFrom that \\(\\frac{dR}{dt}=AR^{-3/2}\\) the relationship between R and t can be found by taking the integral: \\(At=\\frac{2}{5}R^{5/2}\\) meaning that the time is proportional to some constant times \\(R^{5/2}\\) with the values taken from the images of the explosion we can find this constant:\n\n\nCode\nR = np.array([11.1, 19.9, 25.4, 28.8, 31.9, 34.2, 36.3, 38.9, 41, 42.8, 44.4, 46, 46.9, 48.7, 59, 61.1, 62.9, 64.3, 65.6,\n             67.3, 106.5, 130, 145, 175, 185]) #m\nt = np.array([0.1, 0.24, 0.38, 0.52, 0.66, 0.8, 0.94, 1.06, 1.22, 1.36, 1.5, 1.65, 1.79, 1.93, 3.26, 3.53, 3.8, 4.07, 4.34,\n              4.61, 15, 25, 34, 53, 62])*(1e-3) #millisec -&gt; sec\n\n\n\n\nCode\n# find the approximate value of R^5 t^-2\nR5t2 = np.mean((R**5)*(t**(-2)))\n\n\n\n\nCode\n# find the total energy based on gamma and convert to tons TNT\nE = np.array(Ks)*rho_0*R5t2\nE_ergs = E*ergs\nE_TNT = E_ergs / tnt\nE_taylor = [14.4e20, 9.74e20, 7.14e20, 4.06e20] # ergs\n\n\n\n\nCode\n# plot the energy vs the values that Taylor got \nfig = go.Figure()\n\nfig.add_scatter(x=gammas, y=E_TNT[:,0], line_color='black')\nfig.add_hline(y=20000, line_dash='dash', annotation_text='Actual Estimated Energy of Explosion')\nfig.add_scatter(x=[1.2, 1.3, 1.4, 1.667], y=E_taylor, yaxis='y2', mode='markers', marker_color='blue',\n                name='Taylor')\nfig.add_scatter(x=gammas, y=E_ergs[:,0], yaxis='y2', line_color='black', name='Code')\n\nfig.update_layout(yaxis=dict(title='Tons TNT', side='right'), yaxis2=dict(title='Energy (ergs)'), showlegend=False,\n                  xaxis=dict(range=[1.15,1.75]))\n\nfig.show()\n\n\n\n                                                \n\n\nFirst test released an approximate amount of 20,000 tons of TNT (source: Wikipedia )\nThe pressure ratio is \\(\\frac{p}{p_0}=R^{-3}f_1=\\frac{A^2}{a^2}R^{-3}f\\) using that \\(a^2=\\gamma\\frac{p_0}{\\rho_1}\\) we can get that \\(p=p_0A^2\\frac{\\rho_0}{\\gamma p_0}R^{-3}f\\), next using that \\(A=\\frac{2}{5}R^{5/2}t^{-1}\\) the pressure is \\(p=\\frac{\\rho_0}{\\gamma}\\frac{4}{25}R^{5}t^{-2}R^{-3}f\\) to find the max pressure at each value of gamma we need the highest value of f which happens at \\(\\eta=1\\) and is \\(f=\\frac{2\\gamma}{\\gamma+1}\\) so the pressure becomes \\(p_{max}=\\frac{2\\rho_0}{\\gamma+1}\\frac{4}{25}R^{5}t^{-2}R^{-3}\\)\nThe energy is equivalent to \\(E=K\\rho_0 R^{5}t^{-2}\\) so the pressure is \\(p_{max}=\\frac{8}{25}\\frac{E}{K(\\gamma+1)}R^-3\\) where \\(\\frac{E}{K}\\) is a constant value\n\n\nCode\np_z = []\nfor gamma in gammas:\n    g_p = []\n    for i, r in enumerate(R):\n        p_max = (rho_0)*((r**5)*(t[i]**(-2)))*(8/25)*(1/(1+gamma))*r**(-3)\n        g_p.append(p_max)\n    p_z.append(g_p)\n\n\n\n\nCode\n# plot the pressure vs. the radius of the shock and the gamma value\nfig = go.Figure()\n\nfig.add_contour(z=np.log10(p_z), x=R, y=gammas, contours_coloring='heatmap', line_width=0, colorscale='viridis',\n                colorbar=dict(title='Max Pressure [log(P)]', titleside='right'))\nfig.update_layout(xaxis=dict(title='R [m]'), yaxis=dict(title=r'$\\gamma$'))\n\nfig.show()\n\n\n\n                                                \n\n\nEnergy and pressure evaluations are taken from Taylor Part I equations 34-38 and Taylor Part II equations 1-8 as well as tables 1-3"
  },
  {
    "objectID": "couette_flow.html",
    "href": "couette_flow.html",
    "title": "Couette flow",
    "section": "",
    "text": "In this notebook we will study an incompressible fluid experiencing steady Couette flow. Couette flow is named after French physicist Maurice Couette (1858-1943) who studied viscosity and tested the Navier Stokes equations, pictured here:\n\n\n\nCouette flow involves two parallel plates in which only the top plate is moving, as the top plate moves it collides with the molecules in the top layer of fluid between the plates causing momentum to diffuse into the molecules. The molecules in the top layer then collide with those below continuing the diffusion of momentum; these collisions between layers occur down to the bottom plate, each collision diffusing less momentum and therefore each layer having less velocity. Though idealized, Couette flow has many applications in geological systems like the Earth’s mantle and atmosphere as well as in lubrication and thin film applications.\nSource: Maurice Couette\n\n\nCode\n# import libraries that will be needed \nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nimport numpy as np\nimport pandas as pd\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "couette_flow.html#introduction",
    "href": "couette_flow.html#introduction",
    "title": "Couette flow",
    "section": "",
    "text": "In this notebook we will study an incompressible fluid experiencing steady Couette flow. Couette flow is named after French physicist Maurice Couette (1858-1943) who studied viscosity and tested the Navier Stokes equations, pictured here:\n\n\n\nCouette flow involves two parallel plates in which only the top plate is moving, as the top plate moves it collides with the molecules in the top layer of fluid between the plates causing momentum to diffuse into the molecules. The molecules in the top layer then collide with those below continuing the diffusion of momentum; these collisions between layers occur down to the bottom plate, each collision diffusing less momentum and therefore each layer having less velocity. Though idealized, Couette flow has many applications in geological systems like the Earth’s mantle and atmosphere as well as in lubrication and thin film applications.\nSource: Maurice Couette\n\n\nCode\n# import libraries that will be needed \nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nimport numpy as np\nimport pandas as pd\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "couette_flow.html#defining-the-velocity",
    "href": "couette_flow.html#defining-the-velocity",
    "title": "Couette flow",
    "section": "Defining the Velocity ",
    "text": "Defining the Velocity \nFirst, we require a free body diagram.\n\n\nCode\n# plot force diagram\nfig = go.Figure()\nfig.add_shape(type='rect', x0=0, y0=1, x1=4, y1=3, fillcolor='rgba(133, 163, 201, 0.5)')\nfig.add_scatter(x=np.linspace(-1,5, 20), y=np.ones(20)*3.5, line_color='black')\nfig.add_scatter(x=np.linspace(-1,5, 20), y=np.ones(20)*0.5, line_color='black')\nfig.add_annotation(x=-0.1, y=2, ax=-1, ay=2, xref='x', yref='y', axref='x', ayref='y',arrowhead=5, text=\n                   r'$\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}$')\nfig.add_annotation(x=4.1, y=2, ax=6, ay=2, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, text=\n                   r'$\\require{color} {\\color[rgb]{0.315209,0.728565,0.037706}p} + \\frac{\\partial \\\n                   {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} \\delta x$')\nfig.add_annotation(x=1, y=0.9, ax=3, ay=0.9, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, \n                   text=r'$\\require{color}{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}$')\nfig.add_annotation(x=3.5, y=3.25, ax=0.5, ay=3.25, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, text=\n                   r'$\\require{color}{\\color[rgb]{0.990308,0.800015,0.121270}\\tau} + \\frac{\\partial \\\n                   {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y} \\delta y$')\nfig.add_annotation(x=4, y=3.65, ax=0, ay=3.65, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, \n                   text=r'$\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}$')\nfig.add_scatter(x=[2], y=[0.4], mode='text', text=r'$\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}=0$')\nfig.add_annotation(x=-1.2, y=3.5, ax=-1.2, ay=0.4, xref='x', yref='y', axref='x', ayref='y', arrowhead=5)\nfig.add_scatter(x=[-1.3], y=[2], mode='text', text=r'$H$')\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nTo find the acceleration of a fluid particle we need to use the material derivative\n\\[\n\\large\n\\require{color}\n\\vec{a} = \\frac{D{\\color[rgb]{0.059472,0.501943,0.998465}v}}{Dt} = \\frac{\\partial {\\color[rgb]{0.059472,0.501943,0.998465}v}}\n{\\partial t} + \\left({\\color[rgb]{0.059472,0.501943,0.998465}v} \\cdot \\nabla \\right){\\color[rgb]{0.059472,0.501943,0.998465}v}\n\\]\nDue to the fact that the flow is steady\n\\[\n\\frac{\\partial {\\color[rgb]{0.059472,0.501943,0.998465}v}}{\\partial t} = 0\n\\]\nPoiseuille flow also begins with the same derivation.\nAdditionally, velocity in the x-direction is uniform meaning \\(\\frac{\\partial {\\color[rgb]{0.059472,0.501943,0.998465}v}}{\\partial x}=0\\) and \\({\\color[rgb]{0.059472,0.501943,0.998465}v}_y=0\\) therefore\n\\[\n\\large\n\\left({\\color[rgb]{0.059472,0.501943,0.998465}v} \\cdot \\nabla \\right){\\color[rgb]{0.059472,0.501943,0.998465}v} = \\left(v_x \\frac{\\partial}{\\partial x} + v_y \\frac{\\partial}{\\partial y}\\right)v = 0\n\\]\nThus, acceleration in both the x and y directions is zero which tells us that \\(F_{x}=0\\) and \\(F_{y}=0\\). There are two forces acting on the flow, shear and pressure, therefore the vectoral sum of these two forces must sum to zero. The shear stress on the fluid is a function only of y and the pressure is a function only of x, therefore in the y-direction\n\\[\n\\large\n\\require{color}\\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial x} = \\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial y} = 0\n\\]\nFor the \\(x\\) components of shear and pressure to sum to zero they must both be constant along their respective axes. By using the above force diagram we can get a relationship between\n\\[\n\\large\n\\require{color}\\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} \\; \\; \\text{and} \\; \\;  \\require{color}\\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y}\n\\]\n\\[\n\\large\n\\require{color}F_{x} = 0\n\\]\n\\[\n\\large\n\\Rightarrow {\\color[rgb]{0.315209,0.728565,0.037706}p}\\delta y -  \\left({\\color[rgb]{0.315209,0.728565,0.037706}p}+\\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} \\delta x\\right)\\delta y - {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}\\delta x + \\left({\\color[rgb]{0.990308,0.800015,0.121270}\\tau} + \\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y} \\delta y\\right)\\delta x\n\\]\n\\[\n\\large\n\\Rightarrow \\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} = \\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y}\n\\]\nAs pressure is only a function of \\(x\\) and shear stress is only a function of \\(y\\) we can say the partial derivatives from above can be converted to total derivatives \\(\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} = \\frac{d{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{dy}\\). Furthermore, we know the equation for shear stress: \\(\\require{color}{\\color[rgb]{0.990308,0.800015,0.121270}\\tau} = {\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy}\\) so we can get a relationship between velocity and the pressure gradient:\n\\[\n\\large\n\\require{color}\\frac{d}{dy}\\left({\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy}\\right) = {\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d^{2}{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy^{2}} = \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx}\n\\]\nIn Couette flow the pressure gradient is zero, therefore: \\(\\require{color}{\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d^{2}{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy^{2}} =0\\) and we can assume a solution in the form \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}=By+C\\). Using the boundary conditions \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}(0)=0\\) and \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}(H)={\\color[rgb]{0.059472,0.501943,0.998465}V}\\) we can find the solution \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.059472,0.501943,0.998465}V} \\frac{y}{H}\\).\nLet us consider some representative values as shown in the code block below.\n\n\nCode\n# define arbitary constants and the x,y, and velocity values\nH=10\nV=100\nx=np.zeros(10)\ny=np.linspace(0, H-1, 10)\nv_x=V*(y/H)\nv_y=np.zeros(10)"
  },
  {
    "objectID": "couette_flow.html#visualizing-the-flow",
    "href": "couette_flow.html#visualizing-the-flow",
    "title": "Couette flow",
    "section": "Visualizing the Flow ",
    "text": "Visualizing the Flow \nWe are now ready to visualize what this looks like!\n\n\nCode\n# plot vector diagram of the flow velocity profile\nfig = ff.create_quiver(x=x, y=y, u=v_x, v=v_y, arrow_scale=0.05)\nfig.update_layout(xaxis=dict(range=[-1, 11]))\nfig.add_scatter(x=np.linspace(-1,10, 20), y=np.ones(20)*10, line_color='black')\nfig.add_scatter(x=np.linspace(-1,10, 20), y=np.zeros(20), line_color='black')\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nThe plot above shows the velocity vectors at 9 points between the two walls, and illustrates how particles closest to the moving top wall have the most velocity and momentum and this decreases linearly with distance from the top.\n\n\nCode\n# find the total time for the top particle to reach x=10 then calculate the distance each particle travels in that time\ntime = 20/v_x[9]\ntotal_distance = time*v_x\n\n# use time and distance information to show how the horizontal distance bewteen particles starting at the same place changes\nfig = go.Figure()\nframes = [go.Frame(data=[]) for k in range(50)]\nfor i, y_pos in enumerate(y[1:len(y)]):\n    fig.add_scatter(x=np.linspace(0, 20, 20), y=np.ones(20)*y_pos, line_dash='dash', line_color='lightsteelblue')\n    x_pos = np.linspace(0, total_distance[i+1], 50)\n    for j,f in enumerate(frames):\n        f.data += (go.Scatter(x=[x_pos[j]], y=[(np.ones(50)[j]*y_pos)], mode='markers', marker=dict(color='teal', size=10)),)\n\nfig.update(frames=frames)\n\nfig.update_layout(updatemenus = [dict(type='buttons', buttons=[dict(label='play', method='animate', \n                  args=[None, {'frame':{'duration':50}}])])], showlegend=False, xaxis=dict(range=[0,20]))\n\nfig.add_scatter(x=np.linspace(0, 20, 20), y=np.ones(20)*H, line_color='black')\nfig.add_annotation(x=18, y=10.25, ax=2, ay=10.25, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, \n                   text=r'$\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}$')\nfig.add_scatter(x=np.linspace(0, 20, 20), y=np.zeros(20), line_color='black')\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nThis plot animates how an ideallized fluid would move between the two plates, and illustrates how the velocity is a linear function of y."
  },
  {
    "objectID": "flow_around_bend.html",
    "href": "flow_around_bend.html",
    "title": "Flow around a bend",
    "section": "",
    "text": "In this notebook we will study how a fluid acts when it flows around a bend opposed to moving through a straight section. As the fluid is moving around a bend it will be subject to centripetal force, a force that acts within a rotating reference frame and keeps the particles moving in circular motion. Therefore, we will need to use Newton’s second law of motion\n\\[\n\\large\nF={\\color[rgb]{0.501961,0.250953,0.010028}m}a\n\\]\nto see how the pressure gradient affects the velocity throughout the bend. Newton published this law along with his others in his 1687 book the Principia and is pictured here:\n\n\n\nTo understand the relationship between pressure and velocity we need Bernoulli’s equation which was qualitatively postulated by Daniel Bernoulli in 1738 and formally written by Leonhard Euler in 1752 as\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}={\\color[rgb]{0.315209,0.728565,0.037706}p}+\\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}\n\\]\nwhere \\({\\color[rgb]{0.315209,0.728565,0.037706}p}_0\\) is the total or stagnation pressure, \\({\\color[rgb]{0.315209,0.728565,0.037706}p}\\) is the static pressure, and \\(\\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}\\) is the dynamic pressure. Bernoulli (left) and Euler (right) are pictured here:\n\n\n\n\n\n\n\n\n\n\n\n\nSources: Isaac Newton, Daniel Bernoulli, Leonhard Euler\nThe velocity of a flow moving through a bend can be represented in polar coordinates: \\[\n\\large\n\\require{color}\\vec{{\\color[rgb]{0.059472,0.501943,0.998465}v}} = {\\color[rgb]{0.059472,0.501943,0.998465}v}_{r}\\hat{e}_{r} + {\\color[rgb]{0.059472,0.501943,0.998465}v}_{\\theta}\\hat{e}_{\\theta}.\n\\] As the flow is steady the streamlines will follow a circular path, therefore the radial component of velocity is zero, and the velocity will point in the angular direction\n\n\nCode\n# import necessary libraries\nimport plotly.graph_objects as go\nimport numpy as np\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "flow_around_bend.html#introduction",
    "href": "flow_around_bend.html#introduction",
    "title": "Flow around a bend",
    "section": "",
    "text": "In this notebook we will study how a fluid acts when it flows around a bend opposed to moving through a straight section. As the fluid is moving around a bend it will be subject to centripetal force, a force that acts within a rotating reference frame and keeps the particles moving in circular motion. Therefore, we will need to use Newton’s second law of motion\n\\[\n\\large\nF={\\color[rgb]{0.501961,0.250953,0.010028}m}a\n\\]\nto see how the pressure gradient affects the velocity throughout the bend. Newton published this law along with his others in his 1687 book the Principia and is pictured here:\n\n\n\nTo understand the relationship between pressure and velocity we need Bernoulli’s equation which was qualitatively postulated by Daniel Bernoulli in 1738 and formally written by Leonhard Euler in 1752 as\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}={\\color[rgb]{0.315209,0.728565,0.037706}p}+\\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}\n\\]\nwhere \\({\\color[rgb]{0.315209,0.728565,0.037706}p}_0\\) is the total or stagnation pressure, \\({\\color[rgb]{0.315209,0.728565,0.037706}p}\\) is the static pressure, and \\(\\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}\\) is the dynamic pressure. Bernoulli (left) and Euler (right) are pictured here:\n\n\n\n\n\n\n\n\n\n\n\n\nSources: Isaac Newton, Daniel Bernoulli, Leonhard Euler\nThe velocity of a flow moving through a bend can be represented in polar coordinates: \\[\n\\large\n\\require{color}\\vec{{\\color[rgb]{0.059472,0.501943,0.998465}v}} = {\\color[rgb]{0.059472,0.501943,0.998465}v}_{r}\\hat{e}_{r} + {\\color[rgb]{0.059472,0.501943,0.998465}v}_{\\theta}\\hat{e}_{\\theta}.\n\\] As the flow is steady the streamlines will follow a circular path, therefore the radial component of velocity is zero, and the velocity will point in the angular direction\n\n\nCode\n# import necessary libraries\nimport plotly.graph_objects as go\nimport numpy as np\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "flow_around_bend.html#defining-the-velocity-and-pressure",
    "href": "flow_around_bend.html#defining-the-velocity-and-pressure",
    "title": "Flow around a bend",
    "section": "Defining the Velocity and Pressure ",
    "text": "Defining the Velocity and Pressure \nIt will be useful to define the velocity and pressure and see how they are related. As we will be working in polar coordinates, we initialize \\(\\theta\\) values for the plots below.\n\n\nCode\n# initialize theta values for graph \nt1=np.linspace(-np.pi/8,np.pi/8,50)\nt2=np.linspace(-np.pi/2, np.pi/2,50)\n\n\nNow, we will plot a free body diagram for a small elemental area of the bend.\n\n\nCode\n# plot duct and force diagram for small area of flow \nfig = go.Figure()\nfig.add_scatter(x=2*np.cos(t2), y=2*np.sin(t2), fill='tozeroy', fillcolor='rgba(133, 163, 201, 0.5)', line_color='black')\nfig.add_scatter(x=np.cos(t2), y=np.sin(t2), fill='tozeroy', fillcolor='white', line_color='black')\n\nfig.add_scatter(x=1.25*np.cos(t1), y=1.25*np.sin(t1), line_color='black')\nfig.add_scatter(x=1.75*np.cos(t1), y=1.75*np.sin(t1), fill='tonexty', line_color='black', fillcolor = 'steelblue')\nfig.add_scatter(x=np.array([1.25,1.75])*np.cos(np.pi/8), y=np.array([1.25,1.75])*np.sin(np.pi/8), line_color='black', \n                mode='lines')\nfig.add_scatter(x=np.array([1.25,1.75])*np.cos(-np.pi/8), y=np.array([1.25,1.75])*np.sin(-np.pi/8), line_color='black', \n                mode='lines')\n\nfig.add_annotation(x=1.2, y=0, text=r'$\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}$', ax=0.5, ay=0, xref='x', \n                   yref='y', axref='x', ayref='y', arrowhead=5)\nfig.add_annotation(x=1.8, y=0, text=r\"$\\require{color} {\\color[rgb]{0.315209,0.728565,0.037706}p} + \\\n                   \\frac{d {\\color[rgb]{0.315209,0.728565,0.037706}p}}{dr} \\delta r$\", ax=3, ay=0, xref='x', yref='y', \n                   axref='x', ayref='y', arrowhead=5)\nfig.add_annotation(x=0.6, y=0.75, ax=-0.05, ay=-0.09, xref='x', yref='y', axref='x', ayref='y',arrowhead=5)\nfig.add_scatter(x=[0.25], y=[0.5], mode='text', text=r'$r_1$')\nfig.add_annotation(x=0.6, y=-1.9, ax=-0.05, ay=0.09, xref='x', yref='y', axref='x', ayref='y', arrowhead=5)\nfig.add_scatter(x=[0.25], y=[-0.5], mode='text', text=r'$r_2$')\n\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nTo find how the velocity changes with radius we need to use Newton’s second law of motion. The only force acting on the flow is pressure since the flow is inviscid and therefore does not experience shear force. The flow changes direction as it moves around the bend meaning there must be a radial force causing the flow to move in a circular path around the origin. This force is centripetal and is given by the acceleration\n\\[\n\\large\na_{c} = -\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}(r)}{r} \\hat{r}.\n\\]\nTo find the mass we can use the fact that mass is equivalent to density times volume, when done per unit width this is\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.501961,0.250953,0.010028}m}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho}(\\delta l \\delta r)\n\\]\nThen we can use the force diagram above and write out Newton’s second law\n\\[\n\\large\nF=\\require{color}{\\color[rgb]{0.501961,0.250953,0.010028}m}a=-{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}(\\delta l \\delta r) \\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}(r)}{r} = {\\color[rgb]{0.315209,0.728565,0.037706}p} \\delta l -\\left({\\color[rgb]{0.315209,0.728565,0.037706}p} + \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dr} \\delta r\\right)\\delta l.\n\\]\nThis can then be solved for\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dr}\n\\]\nyielding\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dr} = {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}(r)}{r}.\n\\]\nFrom this we can see that the normal pressure gradient is what causes the flow to move in a circular path around the bend. To solve for velocity we will need Bernoulli’s equation:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}={\\color[rgb]{0.315209,0.728565,0.037706}p}+\\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}\n\\]\nwhere \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}\\) is a constant. To relate this equation to the pressure gradient equation we just solved for we must take the derivative of Bernoulli’s equation so that it involves the pressure gradient. The derivative should be taken with respect to the radius as that is the only variable that changes velocity and pressure, remembering that this is incompressible flow we get\n\\[\n\\large\n\\require{color}0=\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dr}+ {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dr}.\n\\].\nPlugging in our previous result for \\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dr}\n\\]\nwe have\n\\[\n\\large\n\\require{color}0={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^{2}(r)}{r} + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}(r) \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}(r)}{dr}.\n\\]\nNext, we can separate the varaibles and integrate both sides:\n\\[\n\\large\n\\require{color}-\\frac{dr}{r} = \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}(r)}{{\\color[rgb]{0.059472,0.501943,0.998465}v}(r)} \\longrightarrow {\\color[rgb]{0.059472,0.501943,0.998465}v}(r)=\\frac{C}{r}\n\\]\nwhere \\(C\\) is a constant to be determined by initial conditions.\nFrom this we can see that the velocity is only dependent on the radius so velocity will be constant along at each radius, as we expected. Using the boundary conditions that\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}(r_1)={\\color[rgb]{0.059472,0.501943,0.998465}v}_0\n\\]\nwe can get that\n\\[\n\\large\n\\require{color}C={\\color[rgb]{0.059472,0.501943,0.998465}v}_{0}r_{1}.\n\\]\nTherefore\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}(r)={\\color[rgb]{0.059472,0.501943,0.998465}v}_{0}\\frac{r_{1}}{r}\n\\]\nwhere \\(r_{1}\\) is the inner radius of the bend.\nLet us now define the necessary variables to calculate the speed at each radii.\n\n\nCode\n# define necessary variables to calculate the speed at each radii\nv_0 = 100 # initial speed at r_1\nr_1 = 1 # inner radius\nr_2 = 2 # outer radius\n\n# calculate the speed between r_1 and r_2\nr = np.linspace(r_1, r_2, 9)\nv = v_0*r_1*(1/r)\n\n\nTo solve for pressure we must use Bernoulli’s equation again. If we assume that at \\(r_1\\) the static pressure is atmospheric \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_a = 101.325 \\ kPa\\) then we can find the stagnation pressure, this stagnation pressure remains constant throughout the bend. To do so we use Bernoulli’s equation at \\(r_1\\) as we know both the pressure and velocity at that point, using those values we get\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_0 = {\\color[rgb]{0.315209,0.728565,0.037706}p}_{\\color[rgb]{0.989013,0.435749,0.811750}a} + \\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}_0^2.\n\\]\nNow we can solve for the pressure at an radius by using the stagnation pressure we just solved for and the equation for velocity that we previously solved for:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}(r) = {\\color[rgb]{0.315209,0.728565,0.037706}p}_0 - \\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2(r) = {\\color[rgb]{0.315209,0.728565,0.037706}p}_0 - \\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}_0^2r_1^2}{r^2}\n\\]\n\\[\n\\large\n\\Rightarrow {\\color[rgb]{0.315209,0.728565,0.037706}p} = {\\color[rgb]{0.315209,0.728565,0.037706}p}_a + \\frac{1}{2} {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}_0^2\\left(1-\\frac{r_1^2}{r^2}\\right)\n\\]\nNext, we define some variables required to work out the pressure\n\n\nCode\n# define variables needed to calculate pressure\nrho = 1.293 # denisty of air in kg/m^3\np_a = 101325 # pressure of air (atmospheric pressure) in Pa\np_0 = p_a + (1/2)*rho*v_0**2\n\n# calculate pressure between r_1 and r_2\np = p_0 - (1/2)*rho*(v_0**2)*(r_1**2)/(r**2)\n\n# define variables needed to make a contour plot\ntheta = np.linspace(0, np.pi/2, 50)\nx=r_2*np.cos(theta)\ny=np.linspace(-2,2,50)"
  },
  {
    "objectID": "flow_around_bend.html#visualizing-the-flow",
    "href": "flow_around_bend.html#visualizing-the-flow",
    "title": "Flow around a bend",
    "section": "Visualizing the Flow ",
    "text": "Visualizing the Flow \nWe are now ready to visualize the velocity and pressure contours!\n\n\nCode\n# define pressure and velocity for contour plot\nv_z = []\np_z = []\nfor y_val in y:\n    v_y_list = []\n    p_y_list = []\n    for x_val in x:\n        if (x_val**2 + y_val**2) &lt; r_1:\n            p_xy = p_a\n            v_xy = v_0\n        else:\n            v_xy = v_0/np.sqrt(x_val**2 + y_val**2)\n            p_xy = p_0 - (1/2)*rho*(v_0**2)*(r_1**2)/(x_val**2 + y_val**2)\n        v_y_list.append(v_xy)\n        p_y_list.append(p_xy)\n    v_z.append(v_y_list)\n    p_z.append(p_y_list)\n\n\nFinally, plotting this yields:\n\n\nCode\n# make contour plots for velocity and pressure  \nfig = go.Figure()\nfig.add_contour(z=v_z, x=x, y=y, contours_coloring='heatmap', line_width=0, colorbar=dict(title='Velocity (m/s)', \n                titleside='right'), colorscale='PuBuGn', reversescale=True)\nfig.add_contour(z=p_z, x=x, y=y, contours_coloring='heatmap', line_width=0, visible=False, colorbar=dict(title=\n                'Pressure (Pa)', titleside='right'), colorscale='dense', reversescale=True)\n\nfig.add_shape(type='circle', xref='x', yref='y', x0=-1, y0=-1, x1=1, y1=1, fillcolor='white', line_color='white')\nfig.add_scatter(x=2*np.cos(t2), y=2*np.sin(t2), line_width=0)\nfig.add_scatter(x=3*np.cos(t2), y=3*np.sin(t2), line_color='white', fill='tonexty', fillcolor='white')\n\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False, range=[-2,2]), \n                  xaxis=dict(showticklabels=False), plot_bgcolor='rgba(0, 0, 0, 0)', autosize=False, width=800, height=800, \n                  showlegend=False, updatemenus=[dict(active=0, buttons=[dict(label='Velocity', method='update', \n                  args=[{'visible':[True, False, True, True, True]}]), dict(label='Pressure', method='update',\n                  args=[{'visible':[False, True, True, True, True]}])], y=1.2, x=0.41)])\nfig.show()\n\n\n\n\n\nAs you can see in the contour plots above the pressure and velocity are inversely proportional to eachother which is what we would expect based on Bernoulli’s equation. Additionally, the velocity decreases with increasing radius which we would also expect because centripetal acceleration decreases as the radius of curvative increases.\n\n\nCode\n# define lines where we want to visualize the flow and time and distance information for those lines\ntotal_distance = np.pi*r\ntotal_time = total_distance / v\ndist = total_time[7] * v\n\nr_lines = np.array([r[1], r[4], r[7]])\nr_dist = np.array([dist[1], dist[4], dist[7]])\nrad = -np.pi/2 + (r_dist / r_lines)\n\n# create animated plot to show ideallized flow movement \nfig = go.Figure()\n\nframes = [go.Frame(data=[]) for k in range(50)]\nfor i, r_line in enumerate(r_lines):\n    fig.add_scatter(x=r_line*np.cos(t2), y=r_line*np.sin(t2), line_dash='dash', line_color='lightsteelblue')\n    x_pos = r_line*np.cos(np.linspace(-np.pi/2, rad[i], 50))\n    y_pos = r_line*np.sin(np.linspace(-np.pi/2, rad[i], 50))\n    try:\n        end = np.where(x_pos &lt; 0)[0][0]\n        x_pos[end:len(x_pos)] = 'NaN'\n    except IndexError:\n        None\n    for j, f in enumerate(frames):\n        f.data += (go.Scatter(x=[x_pos[j]], y=[y_pos[j]], mode='markers', marker=dict(color='teal', size=10)),)\n\nfig.update(frames=frames)\nfig.update_layout(updatemenus = [dict(type='buttons', buttons=[dict(label='play', method='animate', \n                  args=[None, {'frame':{'duration':100}}])])], xaxis=dict(range=[0,2], showticklabels=False), \n                  yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), showlegend=False, \n                  plot_bgcolor='rgba(0, 0, 0, 0)', autosize=False, width=900, height=700)\n\nfig.add_scatter(x=2*np.cos(t2), y=2*np.sin(t2), fill='tozeroy', fillcolor='rgba(133, 163, 201, 0.5)', line_color='black')\nfig.add_scatter(x=np.cos(t2), y=np.sin(t2), fill='tozeroy', fillcolor='white', line_color='black')\n\nfig.show()\n\n\n\n\n\nIn the above animation we can visually see how an idealized fluid would move around a bend, and we can see how the particles at inner radii move faster than those at outer radii"
  },
  {
    "objectID": "normal_shocks.html",
    "href": "normal_shocks.html",
    "title": "Normal shocks",
    "section": "",
    "text": "In this notebook we will study the effect of a shock on a choked converging diverging nozzle. After the flow reaches the throat the flow will transfer to supersonic, meaning the flow is travelling faster than the speed of sound and there can be no more communication between the inlet and exit as it can only move as fast as the speed of sound. This means that fluids that normally react to changes in pressure and temperature can no longer do so. For sound waves at supersonic speeds the source is travelling faster than the waves can propogate (at the speed of sound) and the waves produced by the source will constructvely interfere and form areas of high pressure that lead to a shock. As the pressure outside the nozzle (back pressure) is decreased the shock will move closer to the exit, until the back pressure is lower than the pressure at the throat, at which point a shock will no longer occur within the nozzle and the flow will either be underexpanded, exit pressure is higher than back pressure, or overexpanded, exit pressure is lower than back pressure. The diagram below shows the different cases that can occur in the nozzle, with case C being what we will study\n\n\n\nIn this problem the nozzle is frictionless this means that both before and after the shock the flow is isentropic – no change in entropy / no heat transfer – therefore up until the shock the flow is isentropic and afterwards the flow is also isentropic, across the shock however the flow is not isentropic and the entropy increases.\nSources: Nozzle Diagram\n\n\nCode\n#import relevant libraries \nimport numpy as np\nimport pandas as pd\nfrom scipy.optimize import root_scalar\nfrom scipy import interpolate\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nimport plotly.io as pio\npio.renderers.default = 'iframe'\n\n\nLet us create functions for the duct curvature.\n\n\nCode\n# create functions for duct curvature and an array of x values to use in graphing \nx = np.linspace(0, 1, 200)\nalpha = (x/2 - 0.3)**2 + 0.05 \nbeta = -alpha\n\n# define given variables and constants \np_0i = 140 # kPa\nT_0i = 290 # K\nR = 287 # J/kgK\nc_p = 1006 # J/kgK\ng = 1.4\nshock_x = 0.8 \nthroat_x = 0.6\n\n# assume that flow is choked so the throat Mach number can be defined as 1\nM_t = 1\n\n\nInformation to keep in mind about the flow: - The flow is given to be in a frictionless duct and is a perfect gas - The flow before and after the shock will be isentropic and therefore isentropic flow relations can be used - Across a normal shock the stagnation pressure will drop and stagnation temperature will remain the same - Due to conservation of mass the mass flow rate is constant through out the duct\nThe curvature of the top of the nozzle is given by $ (x) $ and the curvature of the bottom is the negative of the top: \\[\n\\alpha(x) = \\left(\\frac{x}{2}-0.3\\right)^{2} + 0.05 = -\\beta(x)\n\\]\n\\(x\\) is given to be \\(x \\in [0, 1]\\)"
  },
  {
    "objectID": "normal_shocks.html#introduction",
    "href": "normal_shocks.html#introduction",
    "title": "Normal shocks",
    "section": "",
    "text": "In this notebook we will study the effect of a shock on a choked converging diverging nozzle. After the flow reaches the throat the flow will transfer to supersonic, meaning the flow is travelling faster than the speed of sound and there can be no more communication between the inlet and exit as it can only move as fast as the speed of sound. This means that fluids that normally react to changes in pressure and temperature can no longer do so. For sound waves at supersonic speeds the source is travelling faster than the waves can propogate (at the speed of sound) and the waves produced by the source will constructvely interfere and form areas of high pressure that lead to a shock. As the pressure outside the nozzle (back pressure) is decreased the shock will move closer to the exit, until the back pressure is lower than the pressure at the throat, at which point a shock will no longer occur within the nozzle and the flow will either be underexpanded, exit pressure is higher than back pressure, or overexpanded, exit pressure is lower than back pressure. The diagram below shows the different cases that can occur in the nozzle, with case C being what we will study\n\n\n\nIn this problem the nozzle is frictionless this means that both before and after the shock the flow is isentropic – no change in entropy / no heat transfer – therefore up until the shock the flow is isentropic and afterwards the flow is also isentropic, across the shock however the flow is not isentropic and the entropy increases.\nSources: Nozzle Diagram\n\n\nCode\n#import relevant libraries \nimport numpy as np\nimport pandas as pd\nfrom scipy.optimize import root_scalar\nfrom scipy import interpolate\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nimport plotly.io as pio\npio.renderers.default = 'iframe'\n\n\nLet us create functions for the duct curvature.\n\n\nCode\n# create functions for duct curvature and an array of x values to use in graphing \nx = np.linspace(0, 1, 200)\nalpha = (x/2 - 0.3)**2 + 0.05 \nbeta = -alpha\n\n# define given variables and constants \np_0i = 140 # kPa\nT_0i = 290 # K\nR = 287 # J/kgK\nc_p = 1006 # J/kgK\ng = 1.4\nshock_x = 0.8 \nthroat_x = 0.6\n\n# assume that flow is choked so the throat Mach number can be defined as 1\nM_t = 1\n\n\nInformation to keep in mind about the flow: - The flow is given to be in a frictionless duct and is a perfect gas - The flow before and after the shock will be isentropic and therefore isentropic flow relations can be used - Across a normal shock the stagnation pressure will drop and stagnation temperature will remain the same - Due to conservation of mass the mass flow rate is constant through out the duct\nThe curvature of the top of the nozzle is given by $ (x) $ and the curvature of the bottom is the negative of the top: \\[\n\\alpha(x) = \\left(\\frac{x}{2}-0.3\\right)^{2} + 0.05 = -\\beta(x)\n\\]\n\\(x\\) is given to be \\(x \\in [0, 1]\\)"
  },
  {
    "objectID": "normal_shocks.html#defining-the-values",
    "href": "normal_shocks.html#defining-the-values",
    "title": "Normal shocks",
    "section": "Defining the Values ",
    "text": "Defining the Values \n\nDefining the Mach Number and Stagnation Pressure \nThe area distribution above is captured below\n\n\nCode\n# Define a function that solves for an area per unit width (can also solve for different areas such as circular)\ndef area(x):\n    area = 2 * ((x/2 - 0.3)**2 + 0.05)\n    return area\n\n\nTo find the Mach number in the nozzle before the shock we can use the isentropic area ratio Mach number relation[1]:\n\\[\n\\large\n\\require{color}\\frac{A}{A^{*}} = \\frac{\\left(1 + \\frac{\\gamma+1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{\\frac{\\gamma+1}{2(\\gamma-1)}}}{{\\color[rgb]{0.041893,0.355669,0.727621}M}} \\left(\\frac{\\gamma +1}{2}\\right)^{-\\frac{\\gamma +1}{2(\\gamma -1)}}\n\\]\nThere is no analytical solution to find the Mach number from the area ratio so another method must be used, in this notebook optimization is used\n\n\nCode\n# Define the area at the throat, which is needed in order to solve for Mach number\nA_t = area(throat_x)\n\n# Define a mach function to calculate the roots of the area ratio mach relation set to zero\ndef mach_function(M, x_pos):\n    A = area(x_pos)\n    return np.sqrt((1/M**2)*((2/(g+1))*(1+((g-1)/2)*M**2))**((g+1)/(g-1))) - A/A_t\n\n\nIn order to define the Mach number after the shock based on the Mach number before the shock we need to use the relationship [2]:\n\\[\n\\large\n\\require{color}\n{\\color[rgb]{0.041893,0.355669,0.727621}M}_{as}^2 = \\frac{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_s^2 + 2}{2\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_s^2 - (\\gamma -1)}\n\\]\nWhere \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_{as}\\) is the Mach number after the shock and \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_{s}\\) is the Mach number directly before the shock.\n\n\nCode\n# Define the Mach number at the shock position, min Mach value at the entrance, and Mach number after shock\nM_s_root = root_scalar(mach_function, args = (shock_x), x0 = 1, x1 = 2.5)\nM_s = M_s_root.root\n\nM_min_root = root_scalar(mach_function, args = (0), x0 = 0.2, x1 = 1)\nM_min = M_min_root.root\n\nM_as = np.sqrt(((g-1)*M_s**2 + 2)/(2*g*M_s**(2)-(g-1)))\n\n\nTo find the Mach number after the shock we need the mass flow rate[3]:\n\\[\n\\large\n\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}} = \\frac{A{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}}{\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}_{0}}} \\sqrt{\\frac{\\gamma}{{\\color[rgb]{0.986252,0.007236,0.027423}R}}} {\\color[rgb]{0.041893,0.355669,0.727621}M} \\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma -1)}}\n\\]\nThis equation also cannot be solved analytically so the same process as before can be used. Since the mass flow rate must remain constant to obey conservation of mass and the stagnation temperature also remains constant, the area and the stagnation pressure are the only changing variables\nThe stagnation pressure will remain constant from the inlet until the flow reaches the shock. As the stagnation pressure after the shock only depends on the Mach number at the shock and the inlet stagnation pressure we can go ahead and define a function to calculate stagnation pressure[4] based on the normal shock relation:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0s} = {\\color[rgb]{0.315209,0.728565,0.037706}p}_{0i} \\left(\\frac{(\\gamma+1){\\color[rgb]{0.041893,0.355669,0.727621}M}_{s}^{2}}{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_{s}^{2}-2}\\right)^{\\frac{\\gamma}{\\gamma-1}} \\left(\\frac{\\gamma+1}{2 \\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_{s}^{2} - (\\gamma -1)}\\right)^{\\frac{1}{\\gamma-1}},\n\\]\nwhere \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_{s}\\) is the value of the Mach number at the shock.\n\n\nCode\n# Define a function to calculate the stagnation pressure before and after the shock -- based on shock relations\ndef stag_pressure(x_pos):\n    if x_pos &lt; shock_x:\n        stag_pressure = p_0i       \n    else:\n        stag_pressure = p_0i * ((((g + 1) * M_s**2) / ((g - 1) * M_s**2 +2))**(g/(g - 1))) * ((g + 1) / (2*g* M_s**2 - (g -1)))**(1/(g-1))\n    return stag_pressure\n\n# Define the mass flow rate at the throat where M=1 for ease, this number will remain constant\nm_dot = ((A_t)*(p_0i*1000)/(np.sqrt(T_0i)))*np.sqrt(g/R)*((g+1)/2)**(-(g+1)/(2*(g-1))) \n#p0 is multipled by 1000 because it is given in kPa and we need units of Pa\n\n# Define a function that finds the roots of the mass flow rate equation set to zero\ndef mach_function_as(M, x_pos):\n    A = area(x_pos)\n    p_0 = stag_pressure(x_pos)*1000\n    return (A*p_0/np.sqrt(T_0i))*(np.sqrt(g/R))*M*(1+((g-1)/2)*M**2)**(-(g+1)/(2*(g-1))) - m_dot\n\n\n\n\nCode\n# Define a function to calculate the Mach value at an x value, x0 and x1 are lower and upper limits on the Mach number that\n# are based on location in the nozzle\ndef mach_number(x_pos):\n    if x_pos &lt;= 0.5:\n        M_root = root_scalar(mach_function, args = (x_pos), x0 = M_min, x1 = 0.8)\n        M = M_root.root\n    elif 0.5 &lt; x_pos &lt;= throat_x: \n        M_root = root_scalar(mach_function, args = (x_pos), x0 = M_min, x1 = 1)\n        M = M_root.root\n    elif x_pos &lt; shock_x:\n        M_root = root_scalar(mach_function, args = (x_pos), x0 = 1, x1 = M_s)\n        M = M_root.root\n    else: \n        M_root = root_scalar(mach_function_as, args = (x_pos), x0 = M_as, x1 = 0.2)\n        M = M_root.root\n    return M\n\n\n\n\nDefining Static Pressure and Temperature \nAfter you have a function that defines the stagnation pressure and Mach number the static pressure [5] can be calculated using isentropic flow relations, as flow is only momentarily nonisentropic right at the shock so there is a discontinuity:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p} = {\\color[rgb]{0.315209,0.728565,0.037706}p}_{0} \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-\\frac{\\gamma}{\\gamma-1}}\n\\]\n\n\nCode\n# Define a function to calculate the static pressure -- based on isentropic flow relations \ndef static_pressure(x_pos):\n    M = mach_number(x_pos)\n    p_0 = stag_pressure(x_pos)\n    static_pressure = p_0 * (1 + ((g - 1)/2)*M**2)**(-g/(g-1))\n    return static_pressure\n\n\nTo calculate the static temperature[6] isentropic flow relations can also be used, keeping in mind that the stagnation temperature remains constant over a shock:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.121820,0.954406,0.966585}T} = {\\color[rgb]{0.121820,0.954406,0.966585}T}_{0} \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-1}\n\\]\nWhere \\({\\color[rgb]{0.121820,0.954406,0.966585}T}_{0}\\) is the value of the inlet stagnation temperature\n\n\nCode\n# Define a function to calculate the static temperature -- based on isentropic flow relations\ndef static_temperature(x_pos):\n    M = mach_number(x_pos)\n    static_temperature = T_0i * (1 + ((g - 1)/2)*M**2)**(-1)\n    return static_temperature\n\n\n\n\nDefining Velocity \nNow that the Mach number and static temperature can be calculated at every point, the speed of sound and thus the flow speed at each point can be calculated. To calculate the speed of sound [7] we can use:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a} = \\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R} {\\color[rgb]{0.121820,0.954406,0.966585}T}}\n\\]\nTo calculate the speed we can use the relation between Mach number and speed of sound, and solve for speed:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.041893,0.355669,0.727621}M} = \\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}\n\\]\n\n\nCode\n# Define a function to calculate the speed of the particle at each position\ndef speed(x_pos):\n    M = mach_number(x_pos)\n    T = static_temperature(x_pos)\n    a = np.sqrt(g*R*T)\n    v = M * a\n    return v"
  },
  {
    "objectID": "normal_shocks.html#visualizing-the-nozzle",
    "href": "normal_shocks.html#visualizing-the-nozzle",
    "title": "Normal shocks",
    "section": "Visualizing the Nozzle ",
    "text": "Visualizing the Nozzle \n\n\nCode\n# now using the five defined functions from above the values of the five fields of interest can be found at x values\nM_values = []\np0_values = []\np_values = []\nT_values = []\nv_values = []\nfor x_val in x:\n    M_values.append(mach_number(x_val))\n    p0_values.append(stag_pressure(x_val))\n    p_values.append(static_pressure(x_val))\n    T_values.append(static_temperature(x_val))\n    v_values.append(speed(x_val))\n\n\n\nVisualizing Changes in Field Values \n\n\nCode\n# using the dataframe we can also create a plot with a dropdown menu between the fields\nfig = go.Figure()\n\nfig.add_scatter(x=x, y=M_values, line_color = 'plum')\nfig.add_scatter(x=x, y=p0_values, line_color = 'mediumaquamarine', visible=False)\nfig.add_scatter(x=x, y=p_values, line_color = 'cornflowerblue', visible=False)\nfig.add_scatter(x=x, y=T_values, line_color = 'tomato', visible=False)\nfig.add_scatter(x=x, y=v_values, line_color = 'darkmagenta', visible=False)\n\nfig.update_layout(updatemenus = [dict(active=0, buttons = [dict(label='Mach Number', method='update', args=[{'visible':\n                  [True, False, False, False, False]}, {'yaxis':{'title':'Mach Number'}}]), dict(label='Stagnation Pressure',\n                  method='update', args=[{'visible': [False, True, False, False, False]}, {'yaxis':{'title':\n                  'Stagnation Pressure (kPa)'}}]), dict(label='Static Pressure', method='update', args=[{'visible': [False, \n                  False, True, False, False]}, {'yaxis':{'title':'Static Pressure (kPa)'}}]), dict(label='Static Temperature'\n                  , method='update', args=[{'visible': [False, False, False, True, False]}, {'yaxis':{'title':\n                  'Static Temperature (K)'}}]), dict(label='Velocity', method='update', args=[{'visible':[False, False, \n                  False, False, True]}, {'yaxis':{'title':'Velocity (m/s)'}}])])])\n\nfig.update_yaxes(title_text='Mach Number')\nfig.update_xaxes(title_text=\"x position\")\nfig.show()\n\n\n\n\n\nNext we can make contour plots of the fields within the nozzle. As there is no \\(y\\) variation these plots will be uniform in the \\(y\\)-direction, however, when we get to topics such as boundary layers this will change and will no longer be uniform. In reality, isentropic flow is an idealized process as is a frictionless duct. Even in flows with a very low viscosity the viscous forces will never be negligible near a wall and will cause a boundary layer to form thus the field contours would differ along \\(y\\) and can lead to the potential for flow separation. Friction also causes a loss of heat meaning the flow would no longer be adiabatic and causes a drop in enthalpy, therefore reducing efficency as well as the exit Mach number.\n\n\nCode\n# create contour maps of the nozzle\nfig = go.Figure()\n\nfig.add_contour(z=[M_values, M_values], x=x, contours_coloring = 'heatmap', line_width = 0, colorscale = 'deep',\n                reversescale = True, colorbar=dict(title='Mach Number', titleside='right'))\nfig.add_contour(z=[p0_values, p0_values], x=x, contours_coloring ='heatmap', line_width = 0, colorscale = 'Teal', \n                visible = False, colorbar=dict(title='Stagnation Pressure (kPa)', titleside='right'))\nfig.add_contour(z=[p_values, p_values], x=x, contours_coloring = 'heatmap', line_width = 0, colorscale = 'viridis', \n                visible = False, colorbar=dict(title='Static Pressure (kPa)', titleside='right'))\nfig.add_contour(z=[T_values, T_values], x=x, contours_coloring = 'heatmap', line_width = 0, colorscale = 'blackbody', \n                reversescale = True, visible = False, colorbar=dict(title='Static Temperature (K)', titleside='right'))\n\nfig.add_scatter(x=x, y=alpha+0.15, line_color = 'white')\nfig.add_scatter(x=x, y=x-x+0.3, fill='tonexty', fillcolor='white', line_color='white')\nfig.add_scatter(x=x, y=beta+0.15, fill='tozeroy', fillcolor='white', line_color='white')\n\nfig.update_layout(showlegend=False, updatemenus=[dict(active=0, buttons = [dict(label='Mach Number', method='update', args=\n                  [{'visible':[True, False, False, False, True, True, True]}]), dict(label='Stagnation Pressure', \n                  method='update', args=[{'visible':[False, True, False, False, True, True,True]}]), dict(label=\n                  'Static Pressure', method='update', args=[{'visible':[False, False, True, False, True, True, True]}]),\n                  dict(label='Static Temperature', method='update', args=[{'visible':[False, False, False, True, True, True,\n                  True]}])], y=1.2, x=1.1)])\n\nfig.update_yaxes(range=[0, 0.3], showticklabels = False)\nfig.update_xaxes(title='x position')\n\nfig.show()\n\n\n\n\n\n\n\nVisualizing Flow Movement \nFrom the velocity function we can visualize how fluid would move through the nozzle. By utilizing the equation \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v} = \\frac{dx}{dt}\\) we can find the approximate amount of time between each equally spaced \\(x\\) value within the defined array. From time we can find \\(x(t)\\) and linerally interpolate for equally spaced values of \\(t\\) to find approximately how far a particle would move within that time interval.\n\n\nCode\n# find the interval of time between each equally spaced x position \ndx = np.diff(x)\nvav = []\nfor i in range(0, len(dx)):\n    av = sum(v_values[i: i+1]) / 2\n    vav.append(av)\ndt = dx / vav\n\n# find the time at each equally spaced x position \ntime = []\nfor j in range(0, len(x)):\n    time.append(sum(dt[0:j]))\n    \n# interpolate using the x and time values then use the interpolation function to find x positions at equal intervals of time\nf = interpolate.interp1d(x=time, y=x)\ntnew = np.linspace(0, max(time), 500)\nxnew = f(tnew)\n\n\n\n\nCode\n# using the interpolated data we can animate how a particle would move through the nozzle\nfig = go.Figure()\n\nfig.add_scatter(x=x, y=np.zeros(500))\nfig.add_scatter(x=x, y=np.zeros(500), line_dash = 'dot', line_color = 'lightsteelblue')\n\nfig.add_scatter(x=x, y=alpha, line_color = 'black')\nfig.add_scatter(x=x, y=beta, line_color = 'black')\nfig.add_vline(x = shock_x, line_dash = 'dash', line_color = 'red', annotation_text = 'shock')\nfig.add_vline(x = throat_x, line_dash = 'dash', line_color = 'blue', annotation_text = 'throat')\n\nfig.update_layout(xaxis=dict(range=[0,1], autorange=False), yaxis=dict(range=[-0.15, 0.15], autorange=False), updatemenus=\n                  [dict(type='buttons', buttons=[dict(label='play', method='animate', args=[None, {'frame':{'duration':10}}])])])\nfig.update(frames = [go.Frame(data=[go.Scatter(x=[xnew[k]], y=[np.zeros(500)[k]], mode='markers', marker=dict(color='teal',\n                    size=10))]) for k in range(500)], layout_showlegend=False)\n\nfig.show()\n\n\n\n\n\n\n\nCode\n# define x and v values for 18 different positions to create arrows\nx_18 = np.linspace(0,1,18)\nv_18 = []\nfor x_val in x_18:\n    v_18.append(speed(x_val) / 1000)\n    \nalpha_2 = (x_18/3 -0.2)**2 + 0.025\nbeta_2 = -alpha_2\nslope_2 = 2*(x_18/3 - 0.2)/3 * abs(np.append(np.sin(np.arctan(np.diff(alpha_2) / np.diff(x_18))), 0))\n\n\nNow let’s plot the velocity vector field.\n\n\nCode\n# create velocity vector field \nfig = ff.create_quiver(x=np.linspace(0,1,18), y=np.zeros(18), u=v_18, v=np.zeros(18), line_color = 'blue')\nfig2 = ff.create_quiver(x=x_18, y=alpha_2, u=v_18, v=slope_2, line_color = 'blue')\nfig3 = ff.create_quiver(x=x_18, y=beta_2, u=v_18, v=-slope_2, line_color = 'blue')\n\nfig.add_scatter(x=x, y=alpha, line_color = 'black')\nfig.add_scatter(x=x, y=beta, line_color='black')\nfig.update_layout(xaxis=dict(range=[0,1]), yaxis=dict(range=[-0.15, 0.15]), showlegend = False)\n\nfig.add_traces(data = fig2.data)\nfig.add_traces(data = fig3.data)\nfig.show()"
  },
  {
    "objectID": "normal_shocks.html#appendix-formula-derivations",
    "href": "normal_shocks.html#appendix-formula-derivations",
    "title": "Normal shocks",
    "section": "Appendix: Formula Derivations ",
    "text": "Appendix: Formula Derivations \n\nIsentropic Mach Number Area Ratio  [1]\nUsing conservation of mass between the flow at a point to the throat (designated by *) we have that:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} A{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^* A^* {\\color[rgb]{0.059472,0.501943,0.998465}v}^* \\longrightarrow \\frac{A}{A^*} = \\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^* {\\color[rgb]{0.059472,0.501943,0.998465}v}^*}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\]\nNext we multiply and divide the right side by the initial stagnation denisty \\({\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0\\) to get\n\\[\n\\large\n\\require{color}\\frac{A}{A^*}=\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^*}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^*}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\]\nRecognizing that at the throat \\({\\color[rgb]{0.041893,0.355669,0.727621}M}=1\\) so \\({\\color[rgb]{0.989013,0.435749,0.811750}a}^*={\\color[rgb]{0.059472,0.501943,0.998465}v}^*\\) and multiplying and dividing the right side by the speed of sound a at the initial point we have:\n\\[\n\\large\n\\require{color}\\frac{A}{A^*}=\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^*}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\]\nThen using the isentropic flow relation between initial stagnation density and denisty [8] \\(\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}} = \\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{\\frac{1}{\\gamma -1}}\\) using this for both the initial condition and at the throat where \\(\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^*}=\\left(1+\\frac{\\gamma-1}{2}\\right)^{\\frac{1}{\\gamma -1}}\\) we have:\n\\[\n\\large\n\\require{color}\\frac{A}{A^*}=\\left(1+\\frac{\\gamma-1}{2}\\right)^{-\\frac{1}{\\gamma -1}}\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{\\frac{1}{\\gamma -1}}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\]\nThen recognizing that \\(\\require{color}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}=\\frac{1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}}\\) we have:\n\\[\n\\large\n\\require{color}\\frac{A}{A^*}=\\left(1+\\frac{\\gamma-1}{2}\\right)^{-\\frac{1}{\\gamma -1}}\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{\\frac{1}{\\gamma -1}}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}\\frac{1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}}\n\\] \\[\n\\large\n= \\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{1}{\\gamma -1}}\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{\\frac{1}{\\gamma -1}}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}\\frac{1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}}\n\\]\nNext using that \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) [7] we can get that \\(\\require{color}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}=\\frac{\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}^*}}{\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}}=\\sqrt{\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}^*}{{\\color[rgb]{0.121820,0.954406,0.966585}T}}}\\) then multiplying and dividing the right side by \\(\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}\\) we get that \\(\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}=\\sqrt{\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0{\\color[rgb]{0.121820,0.954406,0.966585}T}^*}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0{\\color[rgb]{0.121820,0.954406,0.966585}T}}}\\) and by using the isentropic flow relation between stagnation and static temperature[6] \\(\\require{color}\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}{{\\color[rgb]{0.121820,0.954406,0.966585}T}}=1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\) which at the throat would be \\(\\require{color}\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}{{\\color[rgb]{0.121820,0.954406,0.966585}T}^*}=1+\\frac{\\gamma -1}{2}\\) we get that:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^*}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}=\\sqrt{\\left(1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)\\left(1+\\frac{\\gamma -1}{2}\\right)^{-1}}\n\\]\nPlugging this into the area ratio equation we get:\n\\[\n\\large\n\\require{color}\\frac{A}{A^*}=\\frac{1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}}\\left(\\frac{\\gamma+1}{2}\\right)^{-\\frac{1}{\\gamma -1}}\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{\\frac{1}{\\gamma -1}}\\sqrt{\\left(1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)\\left(1+\\frac{\\gamma -1}{2}\\right)^{-1}}\n\\]\nSimplifying this we get the area ratio mach number relationship:\n\\[\n\\large\n\\require{color}\\frac{A}{A^{*}} = \\frac{\\left(1 + \\frac{\\gamma+1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{\\frac{\\gamma+1}{2(\\gamma-1)}}}{{\\color[rgb]{0.041893,0.355669,0.727621}M}} \\left(\\frac{\\gamma +1}{2}\\right)^{-\\frac{\\gamma +1}{2(\\gamma -1)}}\n\\]\n\n\nNormal Shock Mach Number  [2]\nFirst we compare the speeds before and after the shock using the relationships \\(\\require{color}{\\color[rgb]{0.041893,0.355669,0.727621}M}=\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.989013,0.435749,0.811750}a}}\\) and \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) [7] :\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}_1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}_2}=\\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1{\\color[rgb]{0.989013,0.435749,0.811750}a}_1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2{\\color[rgb]{0.989013,0.435749,0.811750}a}_2}=\\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}}{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}}=\\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2}\\sqrt{\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}}\n\\]\nFrom conservation of mass \\(\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1 A_1 {\\color[rgb]{0.059472,0.501943,0.998465}v}_1 = {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2 A_2 {\\color[rgb]{0.059472,0.501943,0.998465}v}_2\\) and since the change in Mach number at a shock happens instantaneously \\(A_1=A_2\\) therefore \\(\\require{color}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}_1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}_2}=\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\)\nUsing the ideal gas law \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) we have that \\(\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) therefore:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2 {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1 {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_2} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2 {\\color[rgb]{0.121820,0.954406,0.966585}T}_1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1 {\\color[rgb]{0.121820,0.954406,0.966585}T}_2}\n\\]\nWe can find the pressure ratio by using Euler’s equation \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_1 +{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1 {\\color[rgb]{0.059472,0.501943,0.998465}v}_1^2 = {\\color[rgb]{0.315209,0.728565,0.037706}p}_2 +{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2 {\\color[rgb]{0.059472,0.501943,0.998465}v}_2^2\\) and substituting \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\\) and using that \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}=\\sqrt{\\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}}\\) [7]:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_1 + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1 \\left({\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 \\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right) = {\\color[rgb]{0.315209,0.728565,0.037706}p}_2 + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2 \\left({\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2 \\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}\\right)\n\\] \\[\n\\large\n\\Rightarrow {\\color[rgb]{0.315209,0.728565,0.037706}p}_1(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2) = {\\color[rgb]{0.315209,0.728565,0.037706}p}_2(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)\n\\] \\[\n\\large\n\\Rightarrow \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1} = \\frac{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2)}{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)}\n\\]\nWe can find the temperature ratio using isentropic flow relations [6] even though the flow is not isentropic over the shock it is both directly before and after so we can find the temperatures directly before and after and compare them, remembering that across a shock the stagnation pressure remains constant\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.121820,0.954406,0.966585}T}_1 = {\\color[rgb]{0.121820,0.954406,0.966585}T}_0 \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2\\right)^{-1},\n\\] \\[\n\\large\n{\\color[rgb]{0.121820,0.954406,0.966585}T}_2 = {\\color[rgb]{0.121820,0.954406,0.966585}T}_0 \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\right)^{-1}\n\\] \\[\n\\large\n\\Rightarrow \\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2} = \\frac{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2\\right)^{-1}}{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\right)^{-1}}\n\\]\nThen we can solve for \\(\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\) by making these subsitutions:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1} = \\frac{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2)}{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)}\\frac{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\right)}{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2\\right)}\n\\]\nWe can also use the temperature ratio to solve for \\(\\require{color}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}_1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}_2}\\):\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}_1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}_2} = \\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2}\\sqrt{\\frac{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\right)}{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2\\right)}}\n\\]\nSetting these two equivalent we have:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2}\\sqrt{\\frac{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\right)}{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2\\right)}} = \\frac{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2)}{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)}\\frac{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\right)}{\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2\\right)}\n\\]\nMoving terms of \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_1\\) to one side and \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_2\\) to the other we have:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1}{1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2}\\sqrt{1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2} = \\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2}{1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2}\\sqrt{1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2}\n\\]\nNext with some algebra we can solve for \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2\\)\n\\[\n\\large\n\\require{color}\n{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2 = \\frac{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 + 2}{2\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 - (\\gamma -1)}\n\\]\n\n\nMass Flow Rate  [3]\nWe begin again with continuity of mass \\(\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} A{\\color[rgb]{0.059472,0.501943,0.998465}v}\\) and use the relationship between Mach number and velocity \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\\) to get that \\(\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} A{\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\\) then we use the forumla for speed of sound \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) [7] to get that:\n\\[\n\\large\n\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} A{\\color[rgb]{0.041893,0.355669,0.727621}M}\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\n\\]\nThen we use the ideal gas law \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T} \\longrightarrow {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) to substitute for \\({\\color[rgb]{0.814433,0.253157,0.091125}\\rho}\\):\n\\[\n\\large\n\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}}=\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}} A{\\color[rgb]{0.041893,0.355669,0.727621}M}\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}= A{\\color[rgb]{0.041893,0.355669,0.727621}M}\\sqrt{\\frac{\\gamma}{{\\color[rgb]{0.986252,0.007236,0.027423}R}}}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}}}\n\\]\nThen by using the relation that \\(\\require{color}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_0}=\\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}\\right)^{\\frac{\\gamma}{\\gamma -1}}\\) which is derived by dividing the two isentropic flow relations for \\(\\require{color}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_0}\\) and \\(\\require{color}\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}\\) we can substitute for \\({\\color[rgb]{0.315209,0.728565,0.037706}p}\\):\n\\[\n\\large\n\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}}= A{\\color[rgb]{0.041893,0.355669,0.727621}M}\\sqrt{\\frac{\\gamma}{{\\color[rgb]{0.986252,0.007236,0.027423}R}}}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_0\\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}\\right)^{\\frac{\\gamma}{\\gamma -1}}}{\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}}}=A{\\color[rgb]{0.041893,0.355669,0.727621}M}\\sqrt{\\frac{\\gamma}{{\\color[rgb]{0.986252,0.007236,0.027423}R}}}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_0\\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}\\right)^{\\frac{\\gamma+1}{2(\\gamma -1)}}}{\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}}\n\\]\nThen using the isentropic flow relation \\(\\require{color}\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}{{\\color[rgb]{0.121820,0.954406,0.966585}T}}=1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\) [6] we get that:\n\\[\n\\large\n\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}}=A{\\color[rgb]{0.041893,0.355669,0.727621}M}\\sqrt{\\frac{\\gamma}{{\\color[rgb]{0.986252,0.007236,0.027423}R}}}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_0\\left(1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{-\\frac{\\gamma+1}{2(\\gamma -1)}}}{\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}}\n\\]\nRearraging this we get the mass flow equation:\n\\[\n\\large\n\\require{color}\\dot{{\\color[rgb]{0.501961,0.250953,0.010028}m}} = \\frac{A{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}}{\\sqrt{{\\color[rgb]{0.121820,0.954406,0.966585}T}_{0}}} \\sqrt{\\frac{\\gamma}{{\\color[rgb]{0.986252,0.007236,0.027423}R}}} {\\color[rgb]{0.041893,0.355669,0.727621}M} \\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-\\frac{\\gamma+1}{2(\\gamma -1)}}\n\\]\n\n\nStagnation Pressure Ratio  [4]\nFirst we find the pressure ratio between the static pressure before and after the shock by using Euler’s equation \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_1 +{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1 {\\color[rgb]{0.059472,0.501943,0.998465}v}_1^2 = {\\color[rgb]{0.315209,0.728565,0.037706}p}_2 +{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2 {\\color[rgb]{0.059472,0.501943,0.998465}v}_2^2\\) and substituting \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\\) and using that \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}=\\sqrt{\\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}}\\) [7]:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}_1 + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1 \\left({\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 \\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right) = {\\color[rgb]{0.315209,0.728565,0.037706}p}_2 + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2 \\left({\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2 \\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}\\right)\n\\] \\[\n\\large\n\\Rightarrow {\\color[rgb]{0.315209,0.728565,0.037706}p}_1(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2) = {\\color[rgb]{0.315209,0.728565,0.037706}p}_2(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)\n\\] \\[\n\\large\n\\Rightarrow \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1} = \\frac{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2)}{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)}\n\\]\nNext to find the pressure ratio \\(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}}\\) we can multiply the static pressure ratio by \\(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}\\) and \\(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}}\\) to get that \\(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\), then we can use isentropic flow relations between stagnation and static pressure [5] as both directly before and directly after the shock the flow is isentropic so the stagnation and static pressure before can be related and the stagnation and static pressure after can also be related:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}} = \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^{2}\\right)^{-\\frac{\\gamma}{\\gamma-1}}\n\\] \\[\n\\large\n\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}} = \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^{2}\\right)^{-\\frac{\\gamma}{\\gamma-1}}\n\\]\nPlugging this into the relation of stagnation pressures and using the previously derived ratio between static pressures before and after we have:\n\\[\n\\large\n\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}}= \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^{2}\\right)^{-\\frac{\\gamma}{\\gamma-1}}\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^{2}\\right)^{\\frac{\\gamma}{\\gamma-1}}\\frac{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2)}{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2)}\n\\]\nNext using the relation between \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_1\\) and \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_2 \\longrightarrow \\require{color}{\\color[rgb]{0.041893,0.355669,0.727621}M}_2^2 = \\frac{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 + 2}{2\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 - (\\gamma -1)}\\) [2] we can find the stagnation pressure ratio in terms of only \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_1\\) the Mach number before the shock:\n\\[\n\\large\n\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}}= \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^{2}\\right)^{-\\frac{\\gamma}{\\gamma-1}}\\left(1+ \\frac{\\gamma-1}{2}\\left(\\frac{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 + 2}{2\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 - (\\gamma -1)}\\right)\\right)^{\\frac{\\gamma}{\\gamma-1}} \\times\n\\] \\[\n\\large\n\\frac{(1+\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2)}{(1+\\gamma \\left(\\frac{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 + 2}{2\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2 - (\\gamma -1)}\\right))}\n\\]\nBy doing lots of algebra and simplification we arrive at:\n\\[\n\\large\n\\require{color}\n\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{02}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{01}} = \\left(\\frac{(\\gamma+1){\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}^{2}}{(\\gamma-1){\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}^{2}-2}\\right)^{\\frac{\\gamma}{\\gamma-1}} \\left(\\frac{\\gamma+1}{2 \\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}^{2} - (\\gamma -1)}\\right)^{\\frac{1}{\\gamma-1}}\n\\]\n\n\nIsentropic Static to Stagnation Pressure  [5]\nBy starting with the equations \\(\\require{color}d{\\color[rgb]{0.064095,0.501831,0.501977}h}={\\color[rgb]{0.501945,0.999984,0.031006}V}d{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}d{\\color[rgb]{0.121820,0.954406,0.966585}T} \\longrightarrow d{\\color[rgb]{0.121820,0.954406,0.966585}T}=\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}\\) and \\(\\require{color}de=-{\\color[rgb]{0.315209,0.728565,0.037706}p}d{\\color[rgb]{0.501945,0.999984,0.031006}V}=c_vd{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) and substituting for \\(d{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) as well as using the relation \\(\\require{color}\\gamma = \\frac{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{c_v}\\) we get:\n\\[\n\\large\n\\require{color}-{\\color[rgb]{0.315209,0.728565,0.037706}p}d{\\color[rgb]{0.501945,0.999984,0.031006}V} = \\frac{c_{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{\\color[rgb]{0.501945,0.999984,0.031006}V}d{\\color[rgb]{0.315209,0.728565,0.037706}p} \\longrightarrow  -\\gamma \\frac{1}{{\\color[rgb]{0.501945,0.999984,0.031006}V}} d{\\color[rgb]{0.501945,0.999984,0.031006}V} = \\frac{1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}}d{\\color[rgb]{0.315209,0.728565,0.037706}p}\n\\]\nThen by integrating from initial to final conditions:\n\\[\n\\large\n\\require{color}-\\gamma \\int_{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}^{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}\\frac{1}{{\\color[rgb]{0.501945,0.999984,0.031006}V}}d{\\color[rgb]{0.501945,0.999984,0.031006}V} = \\int_{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}^{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}\\frac{1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}}d{\\color[rgb]{0.315209,0.728565,0.037706}p} \\longrightarrow -\\gamma ln\\left(\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}\\right) = ln\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow ln\\left(\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}\\right)^{-\\gamma} = ln\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow \\left(\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}\\right)^{-\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\]\nThen by using the fact that denisty and volue are inversely proportional we can get that:\n\\[\n\\large\n\\require{color}\\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}\\right)^{-\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right) \\longrightarrow \\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right)^{\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\]\nNext we can use the ideal gas law \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T} \\longrightarrow {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) to substitute for \\({\\color[rgb]{0.814433,0.253157,0.091125}\\rho}\\):\n\\[\n\\large\n\\require{color}\\left(\\frac{\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}}{\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}{{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}}\\right)^{\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right) \\longrightarrow \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}\\right)^{\\gamma}\n\\] \\[\n\\large\n\\Rightarrow \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right) \\longrightarrow \\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}\\right) = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)^{\\frac{1}{\\gamma}}\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1} \\right)^{-1} =\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)^{\\frac{1}{1-\\gamma}}\n\\]\nSolving for the pressure ratio we have:\n\\[\n\\large\n\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)=\\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1} \\right)^{\\frac{\\gamma}{\\gamma-1}}\n\\]\nThen we can use the isentropic flow relation between static and stagnation temperature [6] and define the initial condition as being stagnation (we can make this assumption as we can imagine a point in isentropic flow where v=0 and therefore static=stagnation):\n\\[\n\\large\n\\left(\\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-1}\\right)^{\\frac{\\gamma}{\\gamma-1}}=\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}}\n\\]\nSimplifying this we get the isentropic flow relation between static and stagnation pressure:\n\\[\n\\large\n\\require{color}\n\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_{0}} = \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-\\frac{\\gamma}{\\gamma-1}}\n\\]\n\n\nIsentropic Static to Stagnation Temperature  [6]\nIn isentropic flow stagnation enthalpy is conserved and is defined as \\(\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}_0 = {\\color[rgb]{0.064095,0.501831,0.501977}h}+\\frac{1}{2}{\\color[rgb]{0.059472,0.501943,0.998465}v}^2\\) thand enthalpy can be defined as \\(\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) plugging this in we get:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}_0 = {\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T}+ \\frac{1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2}\n\\] \\[\n\\large\n\\Rightarrow \\frac{{\\color[rgb]{0.064095,0.501831,0.501977}h}_0}{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}={\\color[rgb]{0.121820,0.954406,0.966585}T} + \\frac{1}{2{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{\\color[rgb]{0.059472,0.501943,0.998465}v}^2\n\\] \\[\n\\large\n\\Rightarrow {\\color[rgb]{0.121820,0.954406,0.966585}T}_0 = {\\color[rgb]{0.121820,0.954406,0.966585}T} + \\frac{1}{2{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{\\color[rgb]{0.059472,0.501943,0.998465}v}^2\n\\]\nRecognizing that \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\\) and that \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\\) [7] we can replace \\({\\color[rgb]{0.059472,0.501943,0.998465}v}^2\\) with \\(\\require{color}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 \\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) to get:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.121820,0.954406,0.966585}T}_0 = {\\color[rgb]{0.121820,0.954406,0.966585}T} + \\frac{1}{2{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 \\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T} \\longrightarrow \\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}{{\\color[rgb]{0.121820,0.954406,0.966585}T}} = \\left(1+ \\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 \\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}}{2{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}\\right)\n\\]\nNext we can substitute \\(\\require{color}{\\color[rgb]{0.986252,0.007236,0.027423}R}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}-c_v\\) and use the fact that \\(\\require{color}\\gamma = \\frac{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{c_v}\\) to get\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}{{\\color[rgb]{0.121820,0.954406,0.966585}T}} = \\left(1+ \\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 \\gamma ({\\color[rgb]{0.501958,0.501942,0.014744}c_p} - c_v)}{2{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}\\right)\n\\] \\[\n\\large\n= \\left(1+ \\frac{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 \\gamma}{2}\\left(1 - \\frac{1}{\\gamma}\\right)\\right)= \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)\n\\]\nRearranging to get \\(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_0}\\) we get that:\n\\[\n\\large\n\\require{color}\n\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_{0}} = \\left(1+ \\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^{2}\\right)^{-1}\n\\]\n\n\nSpeed of Sound  [7]\nStarting with continuity of mass of a system with decreasing speed: \\(\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} A{\\color[rgb]{0.059472,0.501943,0.998465}v}=({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho})A({\\color[rgb]{0.059472,0.501943,0.998465}v}-d{\\color[rgb]{0.059472,0.501943,0.998465}v})\\) we can solve for the change in velocity:\n\\[\n\\large\n\\require{color}d{\\color[rgb]{0.059472,0.501943,0.998465}v} = \\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\n\\]\nThen using conservation of momentum we have: \\(\\require{color}Ad{\\color[rgb]{0.315209,0.728565,0.037706}p}=A{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 -A({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} +d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho})({\\color[rgb]{0.059472,0.501943,0.998465}v}-d{\\color[rgb]{0.059472,0.501943,0.998465}v})^2\\) then using the equation for \\(d{\\color[rgb]{0.059472,0.501943,0.998465}v}\\) we get:\n\\[\n\\large\n\\require{color}Ad{\\color[rgb]{0.315209,0.728565,0.037706}p}=A{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 -A({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} +d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho})\\left({\\color[rgb]{0.059472,0.501943,0.998465}v}-\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\right)^2\n\\] \\[\n\\large\nA{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 - A({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} +d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho})\\left(\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}+d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\right)^2 = A{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 - A\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2 {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\n\\] \\[\n\\large\nA\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho})}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}} -A\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2 {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}=A{\\color[rgb]{0.059472,0.501943,0.998465}v}^2 \\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}+d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\n\\]\nSolving for \\({\\color[rgb]{0.059472,0.501943,0.998465}v}^2\\) we get:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}^2 = d{\\color[rgb]{0.315209,0.728565,0.037706}p}\\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} + d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\right)\n\\] \\[\n\\large\n=\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\left(1+\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\right)\n\\]\nThe speed of sound is defined as the speed of the wave for small perturbations meaning that \\(\\require{color}d{\\color[rgb]{0.315209,0.728565,0.037706}p} \\rightarrow 0\\), \\(\\require{color}d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\rightarrow 0\\) and \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v} \\rightarrow {\\color[rgb]{0.989013,0.435749,0.811750}a}\\) thus we get:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}^2 = \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\n\\]\nFor an adiabatic process we have that \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}{\\color[rgb]{0.501945,0.999984,0.031006}V}^{\\gamma} = const\\) or equivalently \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^{-\\gamma}=(const) \\longrightarrow {\\color[rgb]{0.315209,0.728565,0.037706}p}=const{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^{-\\gamma}\\) if we take the derivative we get:\n\\[\n\\large\n\\require{color}d{\\color[rgb]{0.315209,0.728565,0.037706}p} = \\gamma {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^{\\gamma-1} d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} (const)\n\\] \\[\n\\large\n\\Rightarrow \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}=\\gamma \\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^{\\gamma}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}(const)\n\\]\nThen using that \\(\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}^{\\gamma} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{const}\\) we have:\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}=\\gamma \\frac{\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{const}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}(const)=\\gamma \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\n\\]\nNext we use the ideal gas law \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) and substitute for \\({\\color[rgb]{0.315209,0.728565,0.037706}p}\\):\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}=\\gamma \\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}} = \\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}\n\\]\nThen using the equation for \\(a\\) that we derived earlier \\(\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}^2 = \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\) we get that:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a} = \\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R} {\\color[rgb]{0.121820,0.954406,0.966585}T}}\n\\]\n\n\nIsentropic Static to Stagnation Density [8]\nBy starting with the equations \\(\\require{color}d{\\color[rgb]{0.064095,0.501831,0.501977}h}={\\color[rgb]{0.501945,0.999984,0.031006}V}d{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}d{\\color[rgb]{0.121820,0.954406,0.966585}T} \\longrightarrow d{\\color[rgb]{0.121820,0.954406,0.966585}T}=\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}\\) and \\(\\require{color}de=-{\\color[rgb]{0.315209,0.728565,0.037706}p}d{\\color[rgb]{0.501945,0.999984,0.031006}V}=c_vd{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) and substituting for \\(d{\\color[rgb]{0.121820,0.954406,0.966585}T}\\) as well as using the relation \\(\\require{color}\\gamma = \\frac{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{c_v}\\) we get:\n\\[\n\\large\n\\require{color}-{\\color[rgb]{0.315209,0.728565,0.037706}p}d{\\color[rgb]{0.501945,0.999984,0.031006}V} = \\frac{c_{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{\\color[rgb]{0.501945,0.999984,0.031006}V}d{\\color[rgb]{0.315209,0.728565,0.037706}p}\n\\]\n\\[\n\\large\n\\Rightarrow  -\\gamma \\frac{1}{{\\color[rgb]{0.501945,0.999984,0.031006}V}} d{\\color[rgb]{0.501945,0.999984,0.031006}V} = \\frac{1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}}d{\\color[rgb]{0.315209,0.728565,0.037706}p}\n\\]\nThen by integrating from initial to final conditions:\n\\[\n\\large\n\\require{color}-\\gamma \\int_{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}^{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}\\frac{1}{{\\color[rgb]{0.501945,0.999984,0.031006}V}}d{\\color[rgb]{0.501945,0.999984,0.031006}V} = \\int_{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}^{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}\\frac{1}{{\\color[rgb]{0.315209,0.728565,0.037706}p}}d{\\color[rgb]{0.315209,0.728565,0.037706}p}\n\\]\n\\[\n\\large\n\\Rightarrow -\\gamma ln\\left(\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}\\right) = ln\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow ln\\left(\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}\\right)^{-\\gamma} = ln\\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow \\left(\\frac{{\\color[rgb]{0.501945,0.999984,0.031006}V}_2}{{\\color[rgb]{0.501945,0.999984,0.031006}V}_1}\\right)^{-\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\]\nThen by using the fact that denisty and volue are inversely proportional we can get that:\n\\[\n\\large\n\\require{color}\\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}\\right)^{-\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow \\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right)^{\\gamma} = \\left(\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}_2}{{\\color[rgb]{0.315209,0.728565,0.037706}p}_1}\\right)\n\\]\nNext we can use the ideal gas law \\(\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}\\):\n\\[\n\\large\n\\require{color}\\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right)^{\\gamma} = \\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1{\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow  \\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right)^{\\gamma}\\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right)^{-1} = \\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow \\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right)^{\\gamma-1} = \\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}\\right)\n\\] \\[\n\\large\n\\Rightarrow \\left(\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_2}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_1}\\right) = \\left(\\frac{{\\color[rgb]{0.121820,0.954406,0.966585}T}_2}{{\\color[rgb]{0.121820,0.954406,0.966585}T}_1}\\right)^{\\frac{1}{\\gamma-1}}\n\\]\nThen we can use the isentropic flow relation between static and stagnation temperature [6] and define the initial condition as being stagnation (we can make this assumption as we can imagine a point in isentropic flow where v=0 and therefore static=stagnation):\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0} = \\left(\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{-1}\\right)^{\\frac{1}{\\gamma -1}}\n\\]\nSimplifying this we get the relationship between static and stagnation density\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}_0} = \\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)^{-\\frac{1}{\\gamma -1}}.\n\\]\nSources: Mass Flow Rate, Isentropic Flow Relations, Normal Shock Relations, AE 3450 Slides, Class Notes"
  },
  {
    "objectID": "supersonic_flow_friction.html",
    "href": "supersonic_flow_friction.html",
    "title": "Supersonic flow with friction",
    "section": "",
    "text": "In this notebook we will study how friction changes the Mach number in a constant area duct. As we will see the coefficient of friction plays the same role as the change in area of a converging frictionless duct, meaning if the flow is originally subsonic the Mach number will increase and if it is originally supersonic the Mach number will decrease.\n\n\nCode\n# import relevant libraries\nimport plotly.graph_objects as go\nimport numpy as np\nfrom scipy.optimize import root_scalar\nfrom IPython.display import Markdown\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "supersonic_flow_friction.html#introduction",
    "href": "supersonic_flow_friction.html#introduction",
    "title": "Supersonic flow with friction",
    "section": "",
    "text": "In this notebook we will study how friction changes the Mach number in a constant area duct. As we will see the coefficient of friction plays the same role as the change in area of a converging frictionless duct, meaning if the flow is originally subsonic the Mach number will increase and if it is originally supersonic the Mach number will decrease.\n\n\nCode\n# import relevant libraries\nimport plotly.graph_objects as go\nimport numpy as np\nfrom scipy.optimize import root_scalar\nfrom IPython.display import Markdown\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "supersonic_flow_friction.html#problem-workthrough",
    "href": "supersonic_flow_friction.html#problem-workthrough",
    "title": "Supersonic flow with friction",
    "section": "Problem Workthrough ",
    "text": "Problem Workthrough \nIt will be useful to consider the following parameters associated with the duct:\n\nDuct parameters\n\n\n\n\n\n\nParameters\nValues\n\n\n\n\nInlet Mach number, \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}\\)\n0.5\n\n\nAxial location at \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}\\), \\(x_1\\)\n2\n\n\nSurface skin friction coefficient, \\(c_f\\)\n0.0025\n\n\nDuct diameter, \\(D\\)\n0.1\n\n\nHeat capacity ratio, \\(\\gamma\\)\n1.4\n\n\n\nOther quantities used here are as per the lecture slides.\n\n\nCode\n# Define constants and known values\nM_1 = 0.5\nx_1 = 2\nc_f = 0.0025\nD = 0.1\ng = 1.4\n\n\nIf the pipe continues onto infinity at some point the flow will choke (reach M=1), this is useful because there is an isentropic flow relation between the Mach number and the distance to the choked position:\nDerivation for this formula may be found in the Appendix section.\n\\[\n\\large\n\\require{color}\\frac{4c_{f}}{D}L = \\frac{1 - {\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}^{2}}{\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2} + \\frac{\\gamma +1}{2\\gamma} \\ \\textrm{ln}\\left(\\frac{\\frac{\\gamma +1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2}{1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2}\\right)\n\\]\nThis finds the maximum required distance for the flow to choke, then since we know the distance between \\(\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}\\) and \\(\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_2\\) (where we want to know the Mach number) we can also find the distance it takes for the flow to choke fro \\(\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_2\\). Then using the distance bwetween \\(\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_2\\) and \\(\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}=1\\) we can solve the above equation for Mach number to find \\(\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_2\\). However, the equation above does not have an analytical solution so a process such as curve fitting or root finding must be used, in this notebook root finding using scipy is used.\n\n\nCode\n# define a function that calculates how far it takes for the flow to choke given the initial mach number \ndef max_L(M):\n    L = (D/(4*c_f))*((1-M**2)/(1.4*M**2) + (g+1)/(2*g) * np.log(((M**2)*(g+1)/2)/(1+(M**2)*(g-1)/2)))\n    return L\n\n# define the length to where the flow chokes and a position we want to find the Mach number \nL_choke = max_L(M_1)\nx_2 = x_1 + L_choke/2\n\nx=np.linspace(0, x_1+L_choke+1, 100)\n\n\nConsider the diagram below that shows the change in the Mach number as a function of the axial location.\n\n\nCode\nfig = go.Figure()\nfig.add_scatter(x=x, y=np.e**(-x) + 1, fill ='tonexty', fillcolor='rgba(133, 163, 201, 0.5)', line_color='blue')\nfig.add_scatter(x=x, y=-np.e**(-x) - 1, fill='tozeroy', fillcolor='rgba(133, 163, 201, 0.5)', line_color='blue')\nfig.add_vline(x=x_1, line_dash='dash', annotation_text=r\"$\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}$\")\nfig.add_vline(x=x_1+L_choke, line_dash='dash', annotation_text=r\"$\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}=1$\")\nfig.add_vline(x=x_2, line_dash='dash', annotation_text=r\"$\\require{color} {\\color[rgb]{0.041893,0.355669,0.727621}M}_{2}$\")\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\nFigure 1: Plot a duct and show where each Mach value is.\n\n\n\nNow, we define the length from \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_{2}\\) to where the flow chokes.\n\n\nCode\n# define the length from M_2 to where the flow chokes\nL_2 = L_choke + x_1 - x_2\n\n# define function to find Mach roots \ndef mach_function(M, L):\n    return (D/(4*c_f))*((1-M**2)/(1.4*M**2) + (g+1)/(2*g) * np.log(((M**2)*(g+1)/2)/(1+(M**2)*(g-1)/2))) - L\n\n# using scipy find the root where L=L_2\nM_2_root = root_scalar(mach_function, args=(L_2), x0=M_1, x1=1)\nM_2 = M_2_root.root\n\nMarkdown(fr'The Mach number at a distance ${round(x_2 - x_1, 3)}m$ from $M_1$ the Mach value is ${round(M_2, 3)}$')\n\n\nThe Mach number at a distance \\(5.345m\\) from \\(M_1\\) the Mach value is \\(0.589\\)"
  },
  {
    "objectID": "supersonic_flow_friction.html#appendix-derivation",
    "href": "supersonic_flow_friction.html#appendix-derivation",
    "title": "Supersonic flow with friction",
    "section": "Appendix: derivation ",
    "text": "Appendix: derivation \nDetailed derivations for the formulas used above are given below. Students need not memorize the formulas, but rather understand how they are derived from first principles.\n\n\nCode\nfig = go.Figure()\nfig.add_shape(type='circle', xref='x', yref='y', x0=0, y0=0, x1=1, y1=3)\nfig.add_shape(type='circle', xref='x', yref='y', x0=3, y0=0, x1=4, y1=3, line_dash='dash')\nfig.add_shape(type='line', x0=0.5, y0=3, x1=3.5, y1=3)\nfig.add_shape(type='line', x0=0.5, y0=0, x1=3.5, y1=0)\nfig.add_annotation(x=0.5, ax=-0.5, y=1.5, ay=1.5, xref='x', axref='x', yref='y', ayref='y', arrowhead=5, \n                   text=r\"$p+\\rho v^2$\")\nfig.add_annotation(x=3.5, ax=5.5, y=1.5, ay=1.5, xref='x', axref='x', yref='y', ayref='y', arrowhead=5, \n                   text=r\"$p + \\frac{dp}{dx}dx+\\rho v^2 +\\frac{d\\rho v^2}{dx}dx$\")\nfig.add_annotation(x=1.5, ax=2.5, y=3.2, ay=3.2, xref='x', axref='x', yref='y', ayref='y', arrowhead=5, text=r\"$\\tau_w$\")\nfig.add_annotation(x=1.5, ax=2.5, y=-0.2, ay=-0.2, xref='x', axref='x', yref='y', ayref='y', arrowhead=5)\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nThe shear force is constant across the surface area of the pipe spanned by a small section of fluid \\(dx\\) this area is \\(2\\pi R dx = \\pi Ddx\\) where \\(D\\) is the diameter of the pipe. The pressure and velocity terms only act on the inlet and exit areas which is given by \\(\\pi R^2 = \\pi \\frac{D^2}{4}\\). Firstly, we must sum the forces:\n\\[\n\\large\n\\require{color}F=-{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}_w\\pi Dd x + \\left( {\\color[rgb]{0.315209,0.728565,0.037706}p} +{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 \\right) \\pi\n\\frac{D^2}{4}  -\\left({\\color[rgb]{0.315209,0.728565,0.037706}p} + \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx}dx + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 + \\frac{d {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{dx}dx\\right)\\pi\n\\frac{D^2}{4} = 0\n\\]\n\\[\n\\large\n\\Rightarrow -\\pi \\frac{D^2}{4}dx\\left(\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} + \\frac{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{dx}\\right) - {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}_w\\pi Ddx = 0\n\\]\n\\[\n\\large\n\\Rightarrow \\require{color}-{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}_w\\pi D = \\pi \\frac{D^2}{4}\\left(\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} + \\frac{d({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2)}{dx}\\right)\n\\]\n\\[\n\\large\n\\Rightarrow -\\frac{4{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}_w}{D} = \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} + \\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{dx}\n\\]\nIf we assume the flow conditions\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} = const, \\; \\; \\; \\; \\; {\\color[rgb]{0.064095,0.501831,0.501977}h} + \\frac{1}{2}{\\color[rgb]{0.059472,0.501943,0.998465}v}^2 = const\n\\]\nthen\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}=0\n\\]\nand\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.064095,0.501831,0.501977}h}}{dx} +\n{\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}=0.\n\\]\nUsing the ideal gas law,\n\\[\n\\large\n{\\color[rgb]{0.315209,0.728565,0.037706}p}={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T},\n\\]\nthe equation for enthalpy is\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T},\n\\]\nwhere\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.986252,0.007236,0.027423}R}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}-c_v,\n\\]\nand\n\\[\n\\large\n\\require{color}\\gamma = \\frac{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{c_v}.\n\\]\nFrom this, one obtains\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}= \\frac{\\gamma -1}{\\gamma} {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.064095,0.501831,0.501977}h}.\n\\]\nAdditionally, since we know that\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\n\\]\nand\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\n\\]\nwe can solve for\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2,\n\\]\nyielding\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.041893,0.355669,0.727621}M}^2{\\color[rgb]{0.989013,0.435749,0.811750}a}^2={\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 = {\\color[rgb]{0.315209,0.728565,0.037706}p}\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}^2\n\\]\nTo expand\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} + \\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{dx}\n\\]\nwe expand the derivative of\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2\n\\]\ninto terms of \\({\\color[rgb]{0.059472,0.501943,0.998465}v}\\) and \\({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\) and we use the expression for \\(p\\) to expand the first term:\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} + {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} = \\frac{\\gamma -1}{\\gamma}\\left({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\frac{d{\\color[rgb]{0.064095,0.501831,0.501977}h}}{dx} + {\\color[rgb]{0.064095,0.501831,0.501977}h}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx}\\right) + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} + {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\] \\[\n\\large\n= \\frac{\\gamma -1}{\\gamma}\\left({\\color[rgb]{0.814433,0.253157,0.091125}\\rho} \\frac{d{\\color[rgb]{0.064095,0.501831,0.501977}h}}{dx} + {\\color[rgb]{0.064095,0.501831,0.501977}h}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx}\\right) + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\]\nUsing that \\(\\require{color}\\frac{d{\\color[rgb]{0.064095,0.501831,0.501977}h}}{dx} + {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}=0 \\longrightarrow \\frac{d{\\color[rgb]{0.064095,0.501831,0.501977}h}}{dx} = -{\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\\) we can further expand the equation to get:\n\\[\n\\large\n\\require{color} \\frac{\\gamma -1}{\\gamma}\\left(-{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} + {\\color[rgb]{0.064095,0.501831,0.501977}h}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx}\\right) + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\]\nThen we can use that \\(\\require{color}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}= \\frac{\\gamma -1}{\\gamma} {\\color[rgb]{0.064095,0.501831,0.501977}h}\\) to further expand to\n\\[\n\\large\n\\require{color}-\\frac{\\gamma -1}{\\gamma}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} + \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx} + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\],\nsimplifying this we get:\n\\[\n\\large\n\\require{color}\\frac{1-\\gamma}{\\gamma}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} + \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx} + \\frac{\\gamma}{\\gamma}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} = \\frac{1}{\\gamma}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} + \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx}\n\\]\nThen using the fact that \\(\\require{color}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}=0\\) we can get that\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}={\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx} + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}=0\n\\] \\[\n\\large\n\\Rightarrow \\frac{1}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx}=-\\frac{1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx},\n\\]\nsubsituting this into the equation we get:\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}={\\color[rgb]{0.059472,0.501943,0.998465}v}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx} + {\\color[rgb]{0.814433,0.253157,0.091125}\\rho}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}=0 \\longrightarrow \\frac{1}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}\\frac{d{\\color[rgb]{0.814433,0.253157,0.091125}\\rho}}{dx}=-\\frac{1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\]\nLastly by using \\(\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 = \\frac{1}{\\gamma}{\\color[rgb]{0.315209,0.728565,0.037706}p}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\) we can get that\n\\[\n\\large\n\\require{color} \\frac{1}{\\gamma}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\].\nSubstituting this in we get:\n\\[\n\\large\n\\require{color}\\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} - \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}({\\color[rgb]{0.041893,0.355669,0.727621}M}^2 - 1)}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\]\nPutting this back into the original force equation we have that:\n\\[\n\\large\n\\require{color}-\\frac{4{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}_w}{D} = \\frac{{\\color[rgb]{0.315209,0.728565,0.037706}p}({\\color[rgb]{0.041893,0.355669,0.727621}M}^2 - 1)}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{dx}\n\\]\nFrom dimensional analysis we know that\n\\[\n\\large\n\\require{color}c_f = \\frac{{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}_w}{\\frac{1}{2}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2},\n\\]\nwhich upon substituting yields\n\\[\n\\large\n\\require{color}\\frac{4c_f}{D}dx = -\\frac{2{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2}({\\color[rgb]{0.041893,0.355669,0.727621}M}^2-1)\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}.\n\\]\nTo solve the above, we need to integrate along \\(x\\) from \\(0\\) to the final length \\(L\\) and from the initial to final velocities:\n\\[\n\\large\n\\require{color}\\int_0^L \\frac{4c_f}{D}dx = \\int_{{\\color[rgb]{0.059472,0.501943,0.998465}v}_1}^{{\\color[rgb]{0.059472,0.501943,0.998465}v}_2} -\\frac{2{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2}({\\color[rgb]{0.041893,0.355669,0.727621}M}^2-1)\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\]\nBy using that\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2 = \\frac{}{\\gamma}{\\color[rgb]{0.315209,0.728565,0.037706}p}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\n\\]\nwe arrive at\n\\[\n\\large\n\\require{color}-\\frac{2{\\color[rgb]{0.315209,0.728565,0.037706}p}}{{\\color[rgb]{0.814433,0.253157,0.091125}\\rho} {\\color[rgb]{0.059472,0.501943,0.998465}v}^2} = -\\frac{2}{\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}^2}.\n\\]\nSubstituting this in we get:\n\\[\n\\large\n\\require{color}\\int_0^L \\frac{4c_f}{D}dx = \\int_{{\\color[rgb]{0.059472,0.501943,0.998465}v}_1}^{{\\color[rgb]{0.059472,0.501943,0.998465}v}_2}  -\\frac{2}{\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}^2}({\\color[rgb]{0.041893,0.355669,0.727621}M}^2-1)\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\n\\]\nWe wish to integrate with one variable, in this case \\({\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\) as we want the relationship between Mach and coefficient of friction, and \\({\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\) is easier to integrate over. To do this we start with the equation for stagnation enthalpy\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}_0 = {\\color[rgb]{0.064095,0.501831,0.501977}h}+\\frac{1}{2}{\\color[rgb]{0.059472,0.501943,0.998465}v}^2\n\\]\nand use\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T}\n\\],\nyielding\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}={\\color[rgb]{0.041893,0.355669,0.727621}M}{\\color[rgb]{0.989013,0.435749,0.811750}a}\n\\],\nand\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\n\\]\nto get:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}_0 = {\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T} + \\frac{1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 \\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}\n\\]\nThen using that \\(\\require{color}{\\color[rgb]{0.986252,0.007236,0.027423}R}={\\color[rgb]{0.501958,0.501942,0.014744}c_p}-c_v\\) we can simplify to get:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}_0 = {\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T} + {\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T}\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 = {\\color[rgb]{0.501958,0.501942,0.014744}c_p}{\\color[rgb]{0.121820,0.954406,0.966585}T}(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2)\n\\]\nNext we solve for temperature from\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.989013,0.435749,0.811750}a}=\\sqrt{\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}{\\color[rgb]{0.121820,0.954406,0.966585}T}}\n\\]\n\\[\n\\large\n\\Rightarrow {\\color[rgb]{0.121820,0.954406,0.966585}T}=\\frac{{\\color[rgb]{0.989013,0.435749,0.811750}a}^2}{{\\color[rgb]{0.986252,0.007236,0.027423}R}\\gamma}=\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}}\n\\],\nplugging this in we have:\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.064095,0.501831,0.501977}h}_0 = {\\color[rgb]{0.501958,0.501942,0.014744}c_p}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}}(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2).\n\\]\nWe need to integrate in order to get a relationship between \\(d{\\color[rgb]{0.059472,0.501943,0.998465}v}\\) and \\(d{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\); to make this easier we take the logarithmic of both sides and use logarithmic rules in order to separate the right hand side:\n\\[\n\\large\n\\require{color}\\textrm{ln}({\\color[rgb]{0.064095,0.501831,0.501977}h}_0) = \\textrm{ln}\\left({\\color[rgb]{0.501958,0.501942,0.014744}c_p}\\frac{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2}{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\gamma {\\color[rgb]{0.986252,0.007236,0.027423}R}}\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)\\right)\n\\]\n\\[\n\\large\n\\Rightarrow \\textrm{ln} \\left(\\frac{{\\color[rgb]{0.501958,0.501942,0.014744}c_p}}{{\\color[rgb]{0.986252,0.007236,0.027423}R}\\gamma}\\right) + \\textrm{ln}\\left({\\color[rgb]{0.059472,0.501943,0.998465}v}^2\\right) - \\textrm{ln}\\left({\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right) + \\textrm{ln}\\left(1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)\n\\]\nThen we can take the derivative of both sides:\n\\[\n\\large\n\\require{color}0 = 0 + \\frac{1}{{\\color[rgb]{0.059472,0.501943,0.998465}v}^2}(2{\\color[rgb]{0.059472,0.501943,0.998465}v}d{\\color[rgb]{0.059472,0.501943,0.998465}v}) - \\frac{1}{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2}d{\\color[rgb]{0.041893,0.355669,0.727621}M}^2 + \\frac{1}{1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2} \\frac{\\gamma-1}{2}d{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\n\\]\n\\[\n\\large\n\\Rightarrow \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}} - \\frac{d{\\color[rgb]{0.041893,0.355669,0.727621}M}^2}{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\left(1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)}\n\\]\nSolving for \\(\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}}\\) we get that:\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}}{{\\color[rgb]{0.059472,0.501943,0.998465}v}} = \\frac{d{\\color[rgb]{0.041893,0.355669,0.727621}M}^2}{2{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\left(1+\\frac{\\gamma-1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)}\n\\]\nThen by substituting this into the integral we have:\n\\[\n\\large\n\\int_0^L \\frac{4c_f}{D}dx = -\\int_{{\\color[rgb]{0.041893,0.355669,0.727621}M}_1}^{{\\color[rgb]{0.041893,0.355669,0.727621}M}_2} \\frac{1}{\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}^2} (1-{\\color[rgb]{0.041893,0.355669,0.727621}M}^2) \\frac{d{\\color[rgb]{0.041893,0.355669,0.727621}M}^2}{{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\left(1+\\frac{(\\gamma-1)}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}^2\\right)}\n\\]\nIntegrating with \\({\\color[rgb]{0.041893,0.355669,0.727621}M}_2 =1\\) we get that:\n\\[\n\\large\n\\require{color}\\frac{4c_{f}}{D}L = \\frac{1 - {\\color[rgb]{0.041893,0.355669,0.727621}M}_{1}^{2}}{\\gamma {\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2} + \\frac{\\gamma +1}{2\\gamma} \\ \\textrm{ln}\\left(\\frac{\\frac{\\gamma +1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2}{1+\\frac{\\gamma -1}{2}{\\color[rgb]{0.041893,0.355669,0.727621}M}_1^2}\\right)\n\\]"
  },
  {
    "objectID": "poiseuille_flow.html",
    "href": "poiseuille_flow.html",
    "title": "Poiseuille flow",
    "section": "",
    "text": "In this notebook we will be studying a incompressible fluid experiencing steady Poiseuille flow. Poiseuille flow is named after Jean Poiseuille (left) a French physicist who derived the equation for how fluids in a pipe move, this equation was also derived by Gotthilf Hagen (middle) at the same time and later justified by George Stokes (right) in 1845.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPoiseuille flow occurs when a fluid driven by a constant pressure gradient flows between two non-moving plates and is both axisymmetric and swirl free. Blood and pipe flow are examples of Poiseuille flow.\nSources: Jean Poiseuille, Gotthilf Hagen, George Stokes\n\n\nCode\n# import necessary libraries \nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nimport plotly.express as px\nimport numpy as np\nimport pandas as pd\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "poiseuille_flow.html#introduction",
    "href": "poiseuille_flow.html#introduction",
    "title": "Poiseuille flow",
    "section": "",
    "text": "In this notebook we will be studying a incompressible fluid experiencing steady Poiseuille flow. Poiseuille flow is named after Jean Poiseuille (left) a French physicist who derived the equation for how fluids in a pipe move, this equation was also derived by Gotthilf Hagen (middle) at the same time and later justified by George Stokes (right) in 1845.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPoiseuille flow occurs when a fluid driven by a constant pressure gradient flows between two non-moving plates and is both axisymmetric and swirl free. Blood and pipe flow are examples of Poiseuille flow.\nSources: Jean Poiseuille, Gotthilf Hagen, George Stokes\n\n\nCode\n# import necessary libraries \nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nimport plotly.express as px\nimport numpy as np\nimport pandas as pd\nimport plotly.io as pio\npio.renderers.default = 'iframe'"
  },
  {
    "objectID": "poiseuille_flow.html#defining-the-velocity",
    "href": "poiseuille_flow.html#defining-the-velocity",
    "title": "Poiseuille flow",
    "section": "Defining the Velocity ",
    "text": "Defining the Velocity \nIt will be very useful to consider a free body diagram of a fluid blob.\n\n\nCode\n# plot force diagram\nfig = go.Figure()\nfig.add_shape(type='rect', x0=0, y0=1, x1=4, y1=3, fillcolor='rgba(133, 163, 201, 0.5)')\nfig.add_scatter(x=np.linspace(-1,5, 20), y=np.ones(20)*3.5, line_color='black')\nfig.add_scatter(x=np.linspace(-1,5, 20), y=np.ones(20)*0.5, line_color='black')\nfig.add_annotation(x=-0.1, y=2, ax=-1, ay=2, xref='x', yref='y', axref='x', ayref='y',arrowhead=5, text=\n                   r'$\\require{color}{\\color[rgb]{0.315209,0.728565,0.037706}p}$')\nfig.add_annotation(x=4.1, y=2, ax=6, ay=2, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, text=\n                   r'$\\require{color} {\\color[rgb]{0.315209,0.728565,0.037706}p} + \\frac{\\partial \\\n                   {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} \\delta x$')\nfig.add_annotation(x=1, y=0.9, ax=3, ay=0.9, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, \n                   text=r'$\\require{color}{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}$')\nfig.add_annotation(x=3.5, y=3.25, ax=0.5, ay=3.25, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, text=\n                  r'$\\require{color}{\\color[rgb]{0.990308,0.800015,0.121270}\\tau} + \\frac{\\partial \\\n                  {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y} \\delta y$')\nfig.add_scatter(x=[2], y=[3.65], mode='text', text=r'$\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}=0$')\nfig.add_scatter(x=[2], y=[0.4], mode='text', text=r'$\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}=0$')\nfig.add_annotation(x=-1.2, y=3.5, ax=-1.2, ay=0.4, xref='x', yref='y', axref='x', ayref='y', arrowhead=5)\nfig.add_scatter(x=[-1.3], y=[2], mode='text', text=r'$H$')\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nTo find the acceleration of a fluid particle we need to use the material derivative:\n\\[\n\\large\n\\require{color}\n\\vec{a} = \\frac{D{\\color[rgb]{0.059472,0.501943,0.998465}v}}{Dt} = \\frac{\\partial {\\color[rgb]{0.059472,0.501943,0.998465}v}}\n{\\partial t} + \\left({\\color[rgb]{0.059472,0.501943,0.998465}v} \\cdot \\nabla \\right){\\color[rgb]{0.059472,0.501943,0.998465}v}\n\\]\nDue to the fact that the flow is steady\n\\[\n\\large\n\\frac{\\partial {\\color[rgb]{0.059472,0.501943,0.998465}v}}{\\partial t} = 0.\n\\]\nAdditionally, the velocity in the x-direction is uniform. This implies\n\\[\n\\large\n\\frac{\\partial {\\color[rgb]{0.059472,0.501943,0.998465}v}}{\\partial x}=0\n\\]\nand\n\\[\n\\large\n{\\color[rgb]{0.059472,0.501943,0.998465}v}_y=0,\n\\]\ntherefore\n\\[\n\\left({\\color[rgb]{0.059472,0.501943,0.998465}v} \\cdot \\nabla \\right){\\color[rgb]{0.059472,0.501943,0.998465}v} = \\left(v_x \\frac{\\partial}{\\partial x} + v_y \\frac{\\partial}{\\partial y}\\right)v = 0.\n\\]\nThus, acceleration in both the x and y directions is zero which tells us that \\(F_{x}=0\\) and \\(F_{y}=0\\). There are two forces acting on the flow, shear and pressure, therefore the vectoral sum of these two forces must sum to zero. The shear stress on the fluid is a function only of y and the pressure is a function only of x, therefore in the y-direction\n\\[\n\\large\n\\require{color}\\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial x} = \\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial y} = 0\n\\]\nFor the x components of shear and pressure to sum to zero they must both be constant along their respective axes. By using the above force diagram we can get a relationship between \\(\\require{color}\\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x}\\) and $ $.\nBy summing the forces, we write \\[\n\\large\n\\require{color}F_{x} = 0\n\\] \\[\n\\large\n= {\\color[rgb]{0.315209,0.728565,0.037706}p}\\delta y -  \\left({\\color[rgb]{0.315209,0.728565,0.037706}p}+\\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} \\delta x\\right)\\delta y - {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}\\delta x + \\left({\\color[rgb]{0.990308,0.800015,0.121270}\\tau} + \\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y} \\delta y\\right)\\delta x\n\\] \\[\n\\large\n\\Rightarrow \\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x} = \\frac{\\partial {\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{\\partial y}\n\\]\nAs the pressure is only a function of x and shear stress is only a function of y we can say the partial derivatives from above can be converted to total derivatives:\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} = \\frac{d{\\color[rgb]{0.990308,0.800015,0.121270}\\tau}}{dy}.\n\\]\nFurthermore, we know the equation for shear stress\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.990308,0.800015,0.121270}\\tau} = {\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy}\n\\]\nso we can get a relationship between velocity and the pressure gradient\n\\[\n\\large\n\\require{color}\\frac{d}{dy}\\left({\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy}\\right) = {\\color[rgb]{0.990448,0.502245,0.032881}\\mu} \\frac{d^{2}{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}}{dy^{2}} = \\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx}.\n\\]\nIn Poiseuille flow the pressure gradient is constant but not zero, therefore we can solve the above equation for \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x}\\) by assuming \\(\\require{color}\\frac{\\partial {\\color[rgb]{0.315209,0.728565,0.037706}p}}{\\partial x}\\) is some constant value thus the solution is in the form \\(\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x} = \\frac{1}{2{\\color[rgb]{0.990448,0.502245,0.032881}\\mu}}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx}y^{2} + By + C\\) where B and C are determined by the boundary conditions.\nThe boundary conditions are: at \\(\\require{color}y=0\\ {\\color[rgb]{0.059472,0.501943,0.998465}v}=0\\) and at \\(\\require{color}y=H\\ {\\color[rgb]{0.059472,0.501943,0.998465}v}=0\\) from these we get that\n\\[\n\\large\n\\require{color}{\\color[rgb]{0.059472,0.501943,0.998465}v}_{x} = \\frac{1}{2{\\color[rgb]{0.990448,0.502245,0.032881}\\mu}}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx}y(y - H).\n\\]\nGiven the above, let us now define the necessary variables.\n\n\nCode\n# define necessary variables \nH=10\ndpdx = -1e-2\nmu = 1e-3\nx=np.zeros(11)\ny=np.linspace(0, H, 11)\nv_x= (1/(2*mu))*(dpdx)*y*(y-H)\nv_y=np.zeros(11)"
  },
  {
    "objectID": "poiseuille_flow.html#visualizing-the-flow",
    "href": "poiseuille_flow.html#visualizing-the-flow",
    "title": "Poiseuille flow",
    "section": "Visualizing the Flow ",
    "text": "Visualizing the Flow \n\nVisualizing How the Flow Moves \nThe code below is used for visualizing how Poiseuille flow behaves.\n\n\nCode\n# create a vector plot showing the velocity vector of particles along y direction each with same x position \nfig = ff.create_quiver(x=x, y=y, u=v_x, v=v_y, arrow_scale=0.04)\nfig.update_layout(xaxis=dict(range=[-1, 20]))\nfig.add_scatter(x=np.linspace(-1,15, 20), y=np.ones(20)*10, line_color='black')\nfig.add_scatter(x=np.linspace(-1,15, 20), y=np.zeros(20), line_color='black')\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nThe plot above shows the velocity vectors at 9 points between the two non-moving walls and illustrates how fast the particles in each “layer” of fluid are moving\n\n\nCode\n# define how long it takes for the fastest particle to travel the length of the pipe\nmax_v = v_x[list(v_x).index(max(v_x))]\ntime = 20/max_v\ndistance = time*v_x\n\n\n\n\nCode\n# using this time animate how the particles would idealy move in Poiseuille flow\nfig = go.Figure()\nframes = [go.Frame(data=[]) for k in range(50)]\nfor i, y_pos in enumerate(y[1:len(y)-1]):\n    fig.add_scatter(x=np.linspace(0, 20, 20), y=np.ones(20)*y_pos, line_dash='dash', line_color='lightsteelblue')\n    x_pos = np.linspace(0, distance[i+1], 50)\n    for j,f in enumerate(frames):\n        f.data += (go.Scatter(x=[x_pos[j]], y=[(np.ones(50)[j]*y_pos)], mode='markers', marker=dict(color='teal', size=10)),)\n\nfig.update(frames=frames)\n\nfig.update_layout(updatemenus = [dict(type='buttons', buttons=[dict(label='play', method='animate', \n                  args=[None, {'frame':{'duration':50}}])])], showlegend=False, xaxis=dict(range=[0,20]))\n\nfig.add_scatter(x=np.linspace(0, 20, 20), y=np.ones(20)*H, line_color='black')\nfig.add_scatter(x=np.linspace(0, 20, 20), y=np.zeros(20), line_color='black')\nfig.update_layout(yaxis=dict(scaleanchor=\"x\", scaleratio=1, showticklabels=False), xaxis=dict(showticklabels=False),\n                  showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.show()\n\n\n\n\n\nThe animation above shows how an ideallized fluid would move through a pipe or non-moving boundary and demonstrates how the flow follows a parabolic velocity profile dependent on y (vertical) coordinate.\n\n\nAdverse and Favorable Pressure Gradients \nAll of the figures in the above section, 3a, are based on the assumption that there is a negative pressure gradient. A negative pressure gradient is considered to be favorable because it allows the flow to move in the direction of initial velocity. However, when the pressure gradient is greater than zero it is considered to be adverse. If the flow were Couette+Poiseuille and the pressure gradient were adverse the flow near the bottom unoving plate would be pushed oppoiste the direction of the moving top plate. In just Poiseuille flow the the velocity profile reverses and the flow would move in the opposite direction to the initial velocity, which is in this case rightwards\n\n\nCode\n# define an array of pressure gradients\ndpdxs = np.linspace(-1e-2, 1e-2, 17)\n\n# create a dictionary of all the y position and velocity data at each pressure gradient \nall_data = {}\nfor p in dpdxs:\n    all_data[p] = {'y':[], 'v':[]}\n    for y_val in y:\n        v_xy = ((1/(2*mu))*(p)*y_val*(y_val-H))\n        all_data[p]['y'].append(y_val)\n        all_data[p]['v'].append(v_xy)\n        \n# create a plot showing how velocity profile changes as the pressure gradient changes \nfig = go.Figure()\nfig.add_scatter(x=np.linspace(-13, 13, 20), y=np.ones(20)*H, line_color='black')\nfig.add_scatter(x=np.linspace(-13, 13, 20), y=np.zeros(20), line_color='black')\n\nframes = []\nfor k in range(0,len(dpdxs)):\n    figaux = ff.create_quiver(x=x, y=all_data[dpdxs[k]]['y'], u=all_data[dpdxs[k]]['v'], v = v_y, arrow_scale=0.04, \n                              line_color='steelblue')\n    frames.append(go.Frame(data=[figaux.data[0]]))\n\nfig.update_layout(updatemenus=[dict(type='buttons', buttons=[dict(label='Play', method='animate',\n                  args=[None, dict(frame=dict(duration=500, redraw=True))])])], xaxis=dict(range=[-13,13], showticklabels=\n                  False), yaxis=dict(showticklabels=False), showlegend=False, plot_bgcolor='rgba(0, 0, 0, 0)')\nfig.update(frames=frames)\n\nfor k in range(len(fig.frames)):\n    fig.frames[k]['layout'].update(title_text=f'Pressure Gradient {round(dpdxs[k],3)}')\n\nfig.add_scatter(x=np.linspace(-13, 13, 20), y=np.ones(20)*H, line_color='black')\nfig.add_annotation(x=5, y=-1, ax=-5, ay=-1, xref='x', yref='y', axref='x', ayref='y', arrowhead=5, text = r'$+x$')\n\nfig.show()\n\n\n\n\n\nIn the above animation you can see that when\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} &gt; 0\n\\]\nthe flow is moving to the left opposing the initial rightwards velocity of the flow. When the flow instead has\n\\[\n\\large\n\\require{color}\\frac{d{\\color[rgb]{0.315209,0.728565,0.037706}p}}{dx} &lt; 0\n\\]\nthe flow moves rightwards in the same direction as the initial velocity."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Overview",
    "section": "",
    "text": "This course comprises three distinct but overlapping modules:\nWhile it is undoubedtly a challenging course, it is important for"
  },
  {
    "objectID": "index.html#lectures",
    "href": "index.html#lectures",
    "title": "Overview",
    "section": "Lectures",
    "text": "Lectures\nThis is a preliminary schedule; it may change throughout the term. The suggested readings (see legend below) are completely optional, but recommended. The example problems are also optional, but recommended. It is not a bad idea to attempt the example problem after each lecture.\n\n\n\nDates\nLecture topic\n\n\n\n\nAug 25\npython, latex, linear algebra, and calculus\n\n\nAug 30\nFluids as a collection of molecules\n\n\nSep 1\nContinuum approach and engineering units\n\n\nSep 6\nConservation of mass (integral & differential forms)\n\n\n\n\n\n\nClass\nParticulars\n\n\n\n\nTime\n8:25 am - 10:20 am\n\n\nLocation\nGuggenheim Aerospace 442"
  }
]